(function(e){function t(t){for(var s,i,o=t[0],c=t[1],l=t[2],u=0,p=[];u<o.length;u++)i=o[u],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&p.push(a[i][0]),a[i]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);d&&d(t);while(p.length)p.shift()();return n.push.apply(n,l||[]),r()}function r(){for(var e,t=0;t<n.length;t++){for(var r=n[t],s=!0,i=1;i<r.length;i++){var c=r[i];0!==a[c]&&(s=!1)}s&&(n.splice(t--,1),e=o(o.s=r[0]))}return e}var s={},a={0:0},n=[];function i(e){return o.p+"js/"+({}[e]||e)+".js"}function o(t){if(s[t])return s[t].exports;var r=s[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.e=function(e){var t=[],r=a[e];if(0!==r)if(r)t.push(r[2]);else{var s=new Promise((function(t,s){r=a[e]=[t,s]}));t.push(r[2]=s);var n,c=document.createElement("script");c.charset="utf-8",c.timeout=120,o.nc&&c.setAttribute("nonce",o.nc),c.src=i(e);var l=new Error;n=function(t){c.onerror=c.onload=null,clearTimeout(u);var r=a[e];if(0!==r){if(r){var s=t&&("load"===t.type?"missing":t.type),n=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+s+": "+n+")",l.name="ChunkLoadError",l.type=s,l.request=n,r[1](l)}a[e]=void 0}};var u=setTimeout((function(){n({type:"timeout",target:c})}),12e4);c.onerror=c.onload=n,document.head.appendChild(c)}return Promise.all(t)},o.m=e,o.c=s,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)o.d(r,s,function(t){return e[t]}.bind(null,s));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var d=l;n.push([0,1]),r()})({0:function(e,t,r){e.exports=r("2f39")},"0096":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("q-banner",{staticClass:"bg-primary text-white",attrs:{rounded:""},scopedSlots:e._u([{key:"avatar",fn:function(){return[r("q-icon",{attrs:{name:"insert_comment",color:"white"}})]},proxy:!0}])},[r("q-icon",{staticClass:"float-right",attrs:{name:"close",color:"white"},on:{click:e.confirmDelete}}),r("div",{staticClass:"row flex"},[r("div",{staticClass:"col-xs-12 col-sm-auto q-mr-md con-name"},[e._v("\n        "+e._s(e.comment.user)+"\n      ")]),r("div",{staticClass:"col-xs-12 col-sm-auto"},[e._v("\n        (le "),r("span",{staticClass:"com-date"},[e._v(e._s(e._f("dateFrench")(e.comment.date)))]),e._v(" à\n        "),r("span",{staticClass:"com-date"},[e._v(e._s(e._f("onlyTime")(e.comment.date)))]),e._v(")\n      ")])]),r("div",{staticClass:"row text-caption com-msg"},[e._v(e._s(e.comment.msg))])],1)],1)},a=[],n=(r("c1df"),{name:"Comment",components:{},data:function(){return{}},props:{comment:{type:Object}},methods:{confirmDelete:function(){var e=this;this.$q.dialog({title:"Confirmation",message:"Voulez-vous vraiment effacer ce commentaire? Cette action est définitive et irréversible!",cancel:!0,persistent:!0}).onOk((function(){e.$emit("deleteComment",e.comment)}))}}}),i=n,o=(r("71ee"),r("2877")),c=r("54e1"),l=r("0016"),u=r("eebe"),d=r.n(u),p=Object(o["a"])(i,s,a,!1,null,null,null);t["default"]=p.exports;d()(p,"components",{QBanner:c["a"],QIcon:l["a"]})},"00e0":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-page-container",[r("q-page",{staticStyle:{"padding-top":"158px"}},[r("div",[r("q-tab-panels",{attrs:{animated:"","keep-alive":!0},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[r("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"articles"}},[r("OrderItems",{attrs:{preparedProducts:e.preparedProducts}})],1),r("q-tab-panel",{attrs:{name:"resume"}},[r("OrderInfos",{staticStyle:{"padding-bottom":"80px"}})],1),r("q-tab-panel",{attrs:{name:"client"}},[r("ClientInfos")],1)],1)],1),r("q-page-sticky",{staticClass:"bg-blue-grey-1 q-pt-md",attrs:{expand:"",position:"top"}},[r("div",{staticClass:"row full-width flex  q-px-lg items-center"},[r("div",{staticClass:"col-4 justify-start items-center"},[r("q-btn",{staticClass:"bg-dark text-white",attrs:{icon:"arrow_back_ios",size:"md",unelevated:"",round:""},on:{click:e.goBackToList}})],1),r("div",{staticClass:" col-8 row justify-end items-center"},[r("ItemsFilter")],1)]),r("div",{staticClass:"row full-width flex items-center q-px-lg q-mt-sm"},["delivery"===e.currentOrder._source.to_customer?r("div",{staticClass:"col-8 row justify-start items-center text-dark",staticStyle:{height:"100px"}},[r("q-icon",{staticClass:"bg-dark",staticStyle:{"border-radius":"60px",padding:"10px",color:"white",width:"30px"},attrs:{size:"30px",name:"directions_bike"}}),e._v("   \n          "),r("div",{staticClass:"row flex text-dark"},[r("div",{staticClass:"col-xs-12 text-h6",staticStyle:{"font-weight":"bold"}},[e._v("\n              #"+e._s(e.orderId)+"\n              "),r("br")]),r("div",{staticClass:"col-xs-12",staticStyle:{"font-weight":"lighter"}},[e._v("\n              Livraison à vélo\n            ")])])],1):e._e(),"pickup"===e.currentOrder._source.to_customer?r("div",{staticClass:"col-8 row justify-start items-center",staticStyle:{height:"100px"}},[r("q-icon",{staticStyle:{"background-color":"black","border-radius":"60px",padding:"10px",color:"white",width:"30px"},attrs:{size:"30px",name:"shopping_bag"}}),e._v("   \n          "),r("div",{staticClass:"row flex"},[r("div",{staticClass:"col-xs-12 text-h6",staticStyle:{"font-weight":"bold"}},[e._v("\n              #"+e._s(e.orderId)+"\n              "),r("br")]),r("div",{staticClass:"col-xs-12",staticStyle:{"font-weight":"lighter"}},[e._v("\n              Commande à récupérer\n            ")])])],1):e._e(),r("div",{staticClass:"col-4 row justify-end text-white"},[r("q-chip",{staticClass:"q-ma-none q-py-lg q-px-sm",staticStyle:{"font-size":"15px","font-weight":"600"},attrs:{square:"",size:"xl",color:"primary","text-color":"white"}},[e._v("\n            "+e._s(e.currentOrder._source.tags.split(",").filter((function(e){return e.includes("-")}))[0])+"\n          ")])],1)]),r("div",{staticClass:"row full-width flex"},[r("q-tabs",{staticClass:"row flex full-width justify-center items-center",attrs:{"active-bg-color":"white",dense:"","indicator-color":"white"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[r("q-tab",{staticClass:"row col-xs-4 justify-center text-dark",attrs:{name:"articles",label:"Articles"}}),r("q-tab",{staticClass:"row col-xs-4 justify-center text-dark",attrs:{name:"resume",label:"Résumé"}}),r("q-tab",{staticClass:"row col-xs-4 justify-center text-dark",attrs:{name:"client",label:"Client"}})],1)],1)]),r("q-page-sticky",{attrs:{expand:"",position:"bottom"}},[r("div",{staticClass:"row full-width flex items-center text-white justify-center",staticStyle:{"box-shadow":"1px -3px 5px rgba(0, 0, 0, 0.2)","background-color":"#70B937"}},[r("q-circular-progress",{staticClass:"q-ma-md float-right",attrs:{"show-value":"","font-size":"14px",value:e.progress,max:e.filteredCurrentOrderItemsLength,size:"50px",thickness:.15,color:"white","track-color":"trackcolor"}},[e._v("\n          "+e._s(Math.round(100*e.progress/e.filteredCurrentOrderItemsLength)||0)+"%\n        ")]),r("span",{staticClass:"q-mr-md",staticStyle:{"font-size":"18px"}},[r("b",[e._v(e._s(e.filteredCurrentOrderItemsLength-e.progress))]),e._v("  produits restants "),r("br")])],1)])],1)],1)},a=[],n=(r("99af"),r("4de4"),r("4160"),r("d81d"),r("45fc"),r("b0c0"),r("cca6"),r("ac1f"),r("5319"),r("159b"),r("96cf"),r("c973")),i=r.n(n),o=r("ded3"),c=r.n(o),l=r("713e"),u=r("c1df"),d=r.n(u),p=r("2f62"),m=r("bdd5"),f=r("58d1"),h=r("9136"),v=r("f7f2"),_=r("43b9"),g=r("f508"),b=r("2ef0"),y=r.n(b),x={name:"ShowOrder",components:{ItemsFilter:h["default"],CallAction:m["default"],OrderItems:l["default"],OrderItem:f["default"],ClientInfos:v["default"],OrderInfos:_["default"]},data:function(){return{preparedProducts:[],filterHasSec:"Sec",filterHasFrais:"Frais",isEditing:!1,tab:"articles",reportRemb:!1,reportReplaced:!1,slackReport:"",report:!1}},computed:c()(c()(c()(c()({},Object(p["c"])("mvpPrep",["currentOrderItems","itemsClicked","itemsClickedDry","itemsClickedFresh","currentOrder","displayedItems"])),Object(p["b"])(["creds"])),Object(p["b"])("mvpPrep",["preparedItems","freshItems","dryItems","orders","modeFilter"])),{},{filteredCurrentOrderItemsLength:function(){return"fresh"===this.modeFilter?this.freshItems.length:"dry"===this.modeFilter?this.dryItems.length:this.currentOrderItems.length},currentOrder:{get:function(){return this.$store.getters["mvpPrep/currentOrder"]},set:function(e){this.$store.commit("mvpPrep/mutate_currentOrder",e)}},progress:function(){return y.a.isEmpty(this.currentOrder)||this.currentOrderItems==[]||y.a.isEmpty(this.currentOrderItems)?0:(e="fresh"===this.modeFilter?this.freshItems:"dry"===this.modeFilter?this.dryItems:this.currentOrderItems,e.filter((function(e){return null!=e._source.prep_status&&""!=e._source.prep_status})).length);var e},userName:function(){return this.creds.user.firstname}}),props:["orderId"],methods:{isFrais:function(e){return e._source.fresh||e._source.frais},goBackToList:function(){var e=this;setTimeout((function(){e.unlock(),setTimeout((function(){var t=Object.assign({},e.$route.query);delete t.showOrder,e.$router.replace({query:t}),e.$router.push({query:{path:"ordersList"}})}),500)}),200)},unlock:function(){var e=this;return i()(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$store.commit("mvpPrep/mutate_preparedItems",e.preparedProducts),!(e.preparedProducts.length>0)){t.next=6;break}return r=function(e){return"replaced"===e||"remb"===e},e.preparedProducts.map((function(e){return e._source.prep_status})).some(r)&&(e.report=!0),t.next=6,e.$store.dispatch("mvpPrep/updateOrderItems",{line_items:e.preparedProducts});case 6:return e.$store.commit("mvpPrep/mutate_scrollView",!0),t.next=9,e.sendUnlockOrder();case 9:return t.next=11,e.$store.dispatch("mvpPrep/getOrders");case 11:case"end":return t.stop()}}),t)})))()},sendUnlockOrder:function(){var e=this;return i()(regeneratorRuntime.mark((function t(){var r,s,a,n,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.currentOrderItems.filter((function(e){return!(e._source.fresh||e._source.frais)&&"remb"===e._source.prep_status})).length,s=e.currentOrderItems.filter((function(e){return(e._source.fresh||e._source.frais)&&"remb"===e._source.prep_status})).length,a=e.currentOrderItems.filter((function(e){return!(e._source.fresh||e._source.frais)&&"success"===e._source.prep_status})).length,n=e.currentOrderItems.filter((function(e){return(e._source.fresh||e._source.frais)&&"success"===e._source.prep_status})).length,i=e.currentOrderItems.filter((function(e){return(e._source.fresh||e._source.frais)&&"replaced"===e._source.prep_status})).length,o=e.currentOrderItems.filter((function(e){return!(e._source.fresh||e._source.frais)&&"replaced"===e._source.prep_status})).length,o+i+r+s+n+a===e.freshItems.length+e.dryItems.length?e.currentOrder._source.prep_status=r>0||s>0?"finishedWithRemb":o>0||i>0?"finishedWithReplaced":"finished":0===e.currentOrderItems.filter((function(e){return""!==e._source.prep_status})).length?e.currentOrder._source.prep_status="":o+r+a===e.dryItems.length&&0!==e.dryItems.length?(e.currentOrder._source.intermediaryStatus="sec",e.currentOrder._source.prep_status="unfinished"):i+s+n===e.freshItems.length&&0!==e.freshItems.length?(e.currentOrder._source.intermediaryStatus="frais",e.currentOrder._source.prep_status="unfinished"):e.currentOrder._source.prep_status="unfinished",e.itemsClicked>0&&(e.currentOrder._source.preparateur=e.userName),e.currentOrder._source.lock=!1,e.currentOrder._source.updatedAt=d()().format("YYYY-MM-DDTHH:mm:ss.SSSSSSZ"),r+s>0&&e.report&&(e.reportRemb=!0),o+i>0&&e.report&&(e.reportReplaced=!0),e.productsReportedToSlack(),t.next=15,e.$store.dispatch({type:"mvpPrep/updateOrder",data:e.currentOrder});case 15:case"end":return t.stop()}}),t)})))()},productsReportedToSlack:function(){if(this.reportReplaced||this.reportRemb){var e={msg:""};e.date=d()(),e.user=this.$store.getters.creds.user.firstname,this.reportRemb&&(e.msg="*Produits remboursés :* \n",this.currentOrderItems.filter((function(e){return"remb"===e._source.prep_status})).forEach((function(t){e.msg+="- ".concat(t._source.name," \n")}))),e.msg+="\n",this.reportReplaced&&(e.msg+="*Produits remplacés :* \n",this.currentOrderItems.filter((function(e){return"replaced"===e._source.prep_status})).forEach((function(t){e.msg+="- ".concat(t._source.name," => ").concat(t._source.replacement," \n")}))),e.apiUrl=this.$store.getters.apiurl,e.apiKey=this.$store.getters.activeApp.config.restApiKey,e.type="direct",e.order=this.currentOrder._id,this.sendToSlack(e)}},sendToSlack:function(e){var t=this;return i()(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.$store.dispatch("mvpPrep/sendMessageToSlack",e);case 3:t.$q.notify({message:"Message envoyé dans slack !",timeout:2e3,color:"green"}),r.next=9;break;case 6:r.prev=6,r.t0=r["catch"](0),t.$q.notify({message:"Un problème est survenu, veuillez re-essayer plus tard.",timeout:2e3,color:"red"});case 9:case"end":return r.stop()}}),r,null,[[0,6]])})))()},preventNav:function(e){e.preventDefault(),this.sendUnlockOrder(),e.returnValue=""},showNotif:function(e){var t=[{color:"green",message:"Préparation frais terminée",icon:"thumb_up"},{color:"teal",message:"Préparation sec terminée",icon:"tag_faces"},{color:"teal",message:"Préparation terminée",icon:"tag_faces"}],r="dry"===this.modeFilter?t[1]:"fresh"===this.modeFilter?t[0]:t[2],s=r.color,a=r.textColor,n=r.multiLine,i=r.icon,o=r.message,c=r.avatar;this.$q.notify({color:s,textColor:a,icon:i,message:o,position:e,avatar:c,multiLine:n,actions:[{handler:function(){}}],timeout:300})},updateOrderStatus:function(){this.currentOrder._source.prep_status="started",this.currentOrder._source.blocker=this.userName,this.currentOrder._source.lock=!0,this.currentOrder._source.lock_type="fresh"===this.modeFilter?"fresh":"dry"===this.modeFilter?"dry":"none",this.currentOrder._source.updatedAt=d()().format("YYYY-MM-DDTHH:mm:ss.SSSSSSZ"),this.$store.dispatch({type:"mvpPrep/updateOrder",data:this.currentOrder})},prepareData:function(){var e=this;return i()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return g["a"].show({delay:100}),t.next=3,e.$store.dispatch("mvpPrep/requestOrder",e.orderId);case 3:return t.next=5,e.updateOrderStatus();case 5:g["a"].hide();case 6:case"end":return t.stop()}}),t)})))()}},watch:{$route:function(e,t){var r=this;return i()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r.prepareData();case 2:case"end":return e.stop()}}),e)})))()},progress:function(e){"fresh"===this.modeFilter?e===this.currentOrderItems.filter((function(e){return e._source.fresh||e._source.frais})).length&&this.itemsClickedFresh>0&&this.showNotif("center"):"dry"===this.modeFilter?e===this.currentOrderItems.filter((function(e){return!(e._source.fresh||e._source.frais)})).length&&this.itemsClickedDry>0&&this.showNotif("center"):"all"===this.modeFilter&&e===this.currentOrderItems.length&&this.itemsClicked>0&&this.showNotif("center")}},beforeCreate:function(){this.$store.commit("mvpPrep/mutate_itemsClicked",0),this.$store.commit("mvpPrep/mutate_itemsClickedDry",0),this.$store.commit("mvpPrep/mutate_itemsClickedFresh",0)},beforeMount:function(){window.addEventListener("beforeunload",this.preventNav),this.prepareData()},destroyed:function(){window.removeEventListener("beforeunload",this.preventNav),this.$store.commit("mvpPrep/mutate_currentOrderItems",[])}},q=x,O=(r("83ca"),r("2877")),w=r("09e3"),k=r("9989"),C=r("adad"),P=r("823b"),S=r("de5e"),I=r("9c40"),$=r("0016"),j=r("b047"),D=r("429b"),M=r("7460"),Q=r("58ea"),L=r("eebe"),T=r.n(L),F=Object(O["a"])(q,s,a,!1,null,"248fcb5b",null);t["default"]=F.exports;T()(F,"components",{QPageContainer:w["a"],QPage:k["a"],QTabPanels:C["a"],QTabPanel:P["a"],QPageSticky:S["a"],QBtn:I["a"],QIcon:$["a"],QChip:j["a"],QTabs:D["a"],QTab:M["a"],QCircularProgress:Q["a"]})},"02ac":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("q-card",{staticClass:"bg-white",attrs:{flat:"",bordered:""}},[r("q-btn",{staticClass:"absolute-top-right text-black q-px-md",attrs:{dense:"",flat:"",color:"primary",icon:"close"},on:{click:e.closeWindow}}),r("div",{staticClass:"row flex-center bg-light-blue-1"},[r("div",[r("h5",[e._v(e._s(e._f("uppercaseFirst")(e.currentOrder.name)))])])]),r("div",{staticClass:"row q-pa-xs"},[r("div",{staticClass:"col-xs-12 col-sm-6 q-pa-sm"},[r("q-list",{attrs:{bordered:"",separator:""}},[r("q-item",[r("q-item-section",[e._v("\n              Date commande :\n            ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n              "+e._s(e._f("dateFrench")(e.currentOrder.expected_date))+"\n            ")])],1),r("q-item",[r("q-item-section",[e._v("\n              Statut actuel :\n            ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[r("q-chip",{attrs:{dense:"",color:e.statusColor,"text-color":"white"}},[e._v("\n                "+e._s(e.status)+"\n              ")])],1)],1)],1)],1),r("div",{staticClass:"col-xs-12 col-sm-6 q-pa-sm"},[r("q-list",{attrs:{bordered:"",separator:""}},[r("q-item",[r("q-item-section",[e._v("\n              Numéro de commande :\n            ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n              "+e._s(e.orderNumber(e.currentOrder.number))+"\n            ")])],1),r("q-item",[r("q-item-section",[e._v("\n              Type de bon :\n            ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n              "+e._s(e.currentOrder.type)+"\n            ")])],1)],1)],1)]),r("div",{staticClass:"row q-pa-xs"},[r("div",{staticClass:"col-xs-12 col-sm-6 q-pa-sm"},[r("q-list",{attrs:{bordered:"",separator:""}},[r("q-item",[r("q-item-section",[e._v("\n              Contact :\n            ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n              "+e._s(e.currentOrder.contact_name)+"\n            ")])],1),r("q-item",[r("q-item-section",[e._v("\n              Téléphone :\n            ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n              "+e._s(e.cleanPhone)+"\n            ")])],1),r("q-item",[r("q-item-section",[e._v("\n              Email :\n            ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n              "+e._s(e.currentOrder.contact_email)+"\n            ")])],1)],1)],1),r("div",{staticClass:"col-xs-12 col-sm-6 q-pa-sm"},[r("q-list",{attrs:{bordered:"",separator:""}},[r("q-item",[r("q-item-section",[e._v("\n              Adresse :\n            ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n              "+e._s(e.currentOrder.address_line_1)),r("br"),e._v("\n              "+e._s(e.currentOrder.post_code)+" "+e._s(e.currentOrder.city)+"\n            ")])],1),r("q-item",[r("q-item-section",[e._v("\n              Complément d'adresse :\n            ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n              "+e._s(e.currentOrder.address_line_2)+"\n            ")])],1)],1)],1)]),r("div",{staticClass:"row q-pa-xs"},[r("div",{staticClass:"col-xs-12 col-sm-6 q-pa-sm"},[r("q-list",{attrs:{bordered:"",separator:""}},[r("q-item",[r("q-item-section",[e._v("\n              Nb d'items commandés :\n            ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n              "+e._s(e.currentOrder.total_items_ordered)+"\n            ")])],1),r("q-item",[r("q-item-section",[e._v("\n              Nb d'items reçus :\n            ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n              "+e._s(e.currentOrder.total_items_received)+"\n            ")])],1)],1)],1),r("div",{staticClass:"col-xs-12 col-sm-6 q-pa-sm"},[r("q-list",{attrs:{bordered:"",separator:""}},[r("q-item",[r("q-item-section",[e._v("\n              Nb total de produits commandés :\n            ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n              "+e._s(e.currentOrder.total_products_ordered)+"\n            ")])],1),r("q-item",[r("q-item-section",[e._v("\n              Poids total (en kg) :\n            ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n              "+e._s(e.currentOrder.total_products_ordered)+"\n            ")])],1),r("q-item",[r("q-item-section",[e._v("\n              Nb total de produits reçus :\n            ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n              "+e._s(e.currentOrder.total_products_received)+"\n            ")])],1)],1)],1)]),r("q-separator"),r("q-btn",{staticClass:"full-width q-my-sm",attrs:{color:"primary",label:"Envoyer sur slack",icon:"chat_bubble_outline",size:"lg"},on:{click:function(t){e.slackPo=!0}}}),r("q-btn",{staticClass:"full-width q-my-sm",attrs:{color:"primary",label:"Commentaire",icon:"notes",size:"lg"},on:{click:function(t){e.comment=!0}}})],1),r("q-dialog",{attrs:{"full-width":""},model:{value:e.slackPo,callback:function(t){e.slackPo=t},expression:"slackPo"}},[r("q-card",{staticClass:"q-pa-xs"},[r("q-card-section",{staticClass:"row items-center"},[r("div",{staticClass:"dialog-box-title"},[e._v("\n          Envoyer un message sur slack concernant cette commande\n        ")])]),r("q-card-section",{staticClass:"row flex-center"},[r("q-input",{staticClass:"full-width",attrs:{filled:"",type:"textarea"},model:{value:e.slackPoMsg,callback:function(t){e.slackPoMsg=t},expression:"slackPoMsg"}})],1),r("q-card-actions",{attrs:{align:"right"}},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Annuler",color:"primary"}}),r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Valider",color:"primary"},on:{click:e.onSlackPo}})],1)],1)],1),r("q-dialog",{attrs:{"full-width":""},model:{value:e.comment,callback:function(t){e.comment=t},expression:"comment"}},[r("q-card",{staticClass:"q-pa-xs"},[r("q-card-section",{staticClass:"row items-center"},[r("div",{staticClass:"dialog-box-title"},[e._v("\n          Attacher un commentaire à cette commande\n        ")])]),r("q-card-section",{staticClass:"row flex-center"},[r("q-input",{staticClass:"full-width",attrs:{filled:"",type:"textarea"},model:{value:e.commentMsg,callback:function(t){e.commentMsg=t},expression:"commentMsg"}})],1),r("q-card-actions",{attrs:{align:"right"}},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Annuler",color:"primary"}}),r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Valider",color:"primary"},on:{click:e.onComment}})],1)],1)],1)],1)},a=[],n=(r("b0c0"),r("d3b7"),r("ac1f"),r("25f0"),r("5319"),r("96cf"),r("c973")),i=r.n(n),o=r("c1df"),c=r.n(o),l={name:"SupplierInfos",data:function(){return{currentOrder:null,slackPo:!1,slackPoMsg:"",comment:!1,commentMsg:"",statusColor:"grey"}},props:{order:{type:Object,required:!0}},methods:{orderNumber:function(e){if("CREATED_BY_NYX"==e)return"n/a"},sendToSlack:function(e){var t=this;return i()(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.$store.dispatch("mvp/sendMessageToSlack",e);case 3:t.$q.notify({message:"Message envoyé !",timeout:5e3,color:"green"}),r.next=9;break;case 6:r.prev=6,r.t0=r["catch"](0),t.$q.notify({message:"Un problème est survenu, veuillez re-essayer plus tard.",timeout:5e3,color:"red"});case 9:case"end":return r.stop()}}),r,null,[[0,6]])})))()},onSlackPo:function(){var e={};e.date=c()(),e.user=this.$store.getters.creds.user.firstname,e.msg=this.slackPoMsg,e.apiUrl=this.$store.getters.apiurl,e.apiKey=this.$store.getters.activeApp.config.restApiKey,e.type="po",e.supplier=this.currentOrder.name,e.poType=this.currentOrder.type,this.sendToSlack(e)},onComment:function(){var e=c()(),t=this.$store.getters.creds.user.firstname+" "+this.$store.getters.creds.user.lastname,r={date:e,user:t,msg:this.commentMsg};this.$emit("addComment",r),this.commentMsg=""},closeWindow:function(){this.$emit("closeSupplier")}},created:function(){console.log(">>>>>>>>>>> ",this.order),this.currentOrder=this.$store.getters["mvpPicking/currentOrder"].details},mounted:function(){},updated:function(){},computed:{status:function(){return"to_be_collected"===this.currentOrder.status?(this.statusColor="primary","En attente de collecte"):"partially_collected"===this.currentOrder.status?(this.statusColor="warning","En cours de collecte"):"fully_collected"===this.currentOrder.status?(this.statusColor="positive","Terminée"):void 0},cleanPhone:function(){var e=this.currentOrder.contact_phone,t=e.replace(/\s+/g,"");return t.toString().replace(/\d{2}(?=.)/g,"$& ")}}},u=l,d=(r("59ea"),r("2877")),p=r("f09f"),m=r("9c40"),f=r("1c1c"),h=r("66e5"),v=r("4074"),_=r("b047"),g=r("eb85"),b=r("24e8"),y=r("a370"),x=r("27f9"),q=r("4b7e"),O=r("7f67"),w=r("eebe"),k=r.n(w),C=Object(d["a"])(u,s,a,!1,null,null,null);t["default"]=C.exports;k()(C,"components",{QCard:p["a"],QBtn:m["a"],QList:f["a"],QItem:h["a"],QItemSection:v["a"],QChip:_["a"],QSeparator:g["a"],QDialog:b["a"],QCardSection:y["a"],QInput:x["a"],QCardActions:q["a"]}),k()(C,"directives",{ClosePopup:O["a"]})},"05e6":function(e,t,r){},"0b9b":function(e,t,r){"use strict";var s=r("23dd"),a=r.n(s);a.a},"10dc":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-card",{staticClass:"bg-white q-pa-xs q-mt-sm q-mb-md",attrs:{flat:"",square:"",bordered:""}},[r("div",{staticClass:"row"},[r("q-select",{ref:"qselect",staticClass:"full-width",attrs:{"use-input":"","input-debounce":"0",label:"AJOUTER UN PRODUIT",options:e.options},on:{filter:e.filterFn,"new-value":e.createValue,input:e.selectedValue,"filter-abort":e.abortFilterFn},scopedSlots:e._u([{key:"no-option",fn:function(){return[r("q-item",[r("q-item-section",{staticClass:"text-grey"},[e._v("\n            Aucun produit référencé chez ce fournisseur\n            "),e.showAddBtn?r("q-btn",{attrs:{color:"primary",label:"Ajouter ce produit"},on:{click:e.addProduct}}):e._e()],1)],1)]},proxy:!0}]),model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)])},a=[],n=(r("4de4"),r("caad"),r("c975"),r("2532"),r("96cf"),r("c973")),i=r.n(n),o=r("bc3a"),c=r.n(o),l={name:"AddItem",props:{supplierName:{type:String,required:!0}},data:function(){return{model:"",otherModel:"",options:[],queryProductsList:{size:500,sort:[{updated_at:{order:"desc",unmapped_type:"boolean"}}],query:{bool:{must:[],filter:[{multi_match:{type:"phrase",query:"",lenient:!0}}]}}},fullProductsList:null,cleanProductsList:null,showAddBtn:!1}},methods:{filterFn:function(e,t,r){var s=this;null===this.cleanProductsList?t((function(){s.getProductsList()})):t((function(){var t=e.toLocaleLowerCase();s.options=s.cleanProductsList.filter((function(e){return e.toLocaleLowerCase().indexOf(t)>-1})),0===s.options.length&&e.length>2?(s.showAddBtn=!0,s.otherModel=e):s.showAddBtn=!1}))},abortFilterFn:function(){},createValue:function(e,t){e.length>0&&(this.options.includes(e)||this.addThisProduct(e))},addProduct:function(){this.addThisProduct(this.otherModel),this.otherModel="",this.model="",this.$refs.qselect.hidePopup()},selectedValue:function(e){this.addThisProduct(e),this.model=null},getProductsList:function(){var e=this;return i()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$q.loading.show(),t.next=3,e.requestProductsList();case 3:e.$q.loading.hide();case 4:case"end":return t.stop()}}),t)})))()},requestProductsList:function(){var e=this,t=this.$store.getters.apiurl+"generic_search/product*?token="+this.$store.getters.creds.token;this.queryProductsList.query.bool.filter[0].multi_match.query=this.supplierName,c.a.post(t,this.queryProductsList).then((function(t){e.fullProductsList=t.data.records,e.prepareProducts()})).catch((function(e){}))},prepareProducts:function(){if(this.cleanProductsList=[],this.options=[],0!=this.fullProductsList.length){for(var e=[],t=0;t<this.fullProductsList.length;t++)e[t]=this.fullProductsList[t]._source.title;if(e.sort((function(e,t){var r=e.toLowerCase(),s=t.toLowerCase();return r<s?-1:r>s?1:0})),this.cleanProductsList=e,this.cleanProductsList.length>0){var r=[];for(t=0;t<this.cleanProductsList.length;t++)r.push(this.cleanProductsList[t])}this.options=r}},addThisProduct:function(e){this.$emit("addProduct",{data:e}),this.otherModel="",this.model=""}},created:function(){},mounted:function(){},updated:function(){},computed:{}},u=l,d=r("2877"),p=r("f09f"),m=r("ddd8"),f=r("66e5"),h=r("4074"),v=r("9c40"),_=r("eebe"),g=r.n(_),b=Object(d["a"])(u,s,a,!1,null,null,null);t["default"]=b.exports;g()(b,"components",{QCard:p["a"],QSelect:m["a"],QItem:f["a"],QItemSection:h["a"],QBtn:v["a"]})},"21fe":function(e,t,r){"use strict";var s=r("fbe3"),a=r.n(s);a.a},"22f3":function(e,t,r){},"22f4":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"my-display"},[e.loaded?r("div",{},[r("div",e._l(e.allComments,(function(t){return r("Comment",{key:t.id,staticClass:"q-mb-xs",attrs:{comment:t},on:{deleteComment:e.onDeleteComment}})})),1)]):e._e(),e.loaded?r("q-list",e._l(e.allItems,(function(t,s){return r("CartItem",{key:t.id,attrs:{item_index:s,item:t,closed:e.isClosed},on:{modifyReceived:e.onReceivedModified,deleteItem:e.onDeleteItem,modifyDlc:e.onDlcModified,deleteDlc:e.onDlcDeleted}})})),1):e._e(),e.showAddItem?r("div",{staticClass:"flex-center tppt"},[r("AddItem",{attrs:{supplierName:e.currentOrder.supplier},on:{addProduct:e.onProductAdded}})],1):e._e(),r("q-page-sticky",{attrs:{expand:"",position:"top"}},[e.loaded?r("div",{staticClass:"full-width q-pa-xs bg-primary",staticStyle:{"max-width":"800px"}},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-3 b-c q-pa-xs"},[r("q-btn",{staticClass:"full-width my-btn",attrs:{unelevated:"",padding:"md lg",color:"white","text-color":"primary",icon:"arrow_back_ios",label:e.labelLeft},on:{click:e.backToList}})],1),r("div",{staticClass:"col-6 b-c q-pa-xs"},[r("q-btn",{staticClass:"full-width my-btn",attrs:{unelevated:"",padding:"md lg",color:"white","text-color":"primary",icon:"face",label:e.labelMenu},on:{click:function(t){e.supplierInfoBox=!0}}})],1),r("div",{staticClass:"col-3 b-c q-pa-xs"},[e.isClosed?r("q-btn",{staticClass:"full-width my-btn",attrs:{unelevated:"",padding:"md lg",color:"white","text-color":"primary","icon-right":"create",label:e.labelRightM},on:{click:e.modifyClosed}}):r("q-btn",{staticClass:"full-width my-btn",attrs:{unelevated:"",padding:"md lg",color:"positive","icon-right":"save",label:e.labelRight},on:{click:e.validateOrder}})],1)])]):e._e()]),r("q-dialog",{attrs:{maximized:""},model:{value:e.supplierInfoBox,callback:function(t){e.supplierInfoBox=t},expression:"supplierInfoBox"}},[r("SupplierInfos",{attrs:{order:e.currentOrder},on:{addComment:e.onAddComment,closeSupplier:e.onCloseWindow}})],1),r("q-dialog",{attrs:{"full-width":"",persistent:""},model:{value:e.orderIncomplete,callback:function(t){e.orderIncomplete=t},expression:"orderIncomplete"}},[r("q-card",{staticClass:"q-pa-xs"},[r("q-card-section",{staticClass:"row items-center"},[r("div",{staticClass:"dialog-box-title"},[e._v("\n          Attention\n        ")])]),r("q-card-section",{staticClass:"row flex-center"},[r("q-banner",{staticClass:"bg-orange text-white",attrs:{"inline-actions":"",rounded:""}},[r("div",{staticClass:"text-weight-medium text-body1"},[e._v("\n            Vous ne pouvez pas encore valider ce bon de commande.\n          ")]),r("div",{staticClass:"text-weight-medium text-body1"},[e._v("\n            Tous les produits doivent avoir une quantité avant de pouvoir\n            valider un bon.\n          ")])])],1),r("q-card-actions",{attrs:{align:"right"}},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"j'ai compris",color:"primary"}})],1)],1)],1)],1)},a=[],n=(r("a630"),r("a434"),r("cca6"),r("3ca3"),r("96cf"),r("c973")),i=r.n(n),o=r("2b0e"),c=r("bc3a"),l=r.n(c),u=r("c1df"),d=r.n(u),p=r("10dc"),m=r("0096"),f=r("84c1"),h=r("02ac");o["a"].component("SupplierInfos",h["default"]),o["a"].component("CartItem",f["default"]),o["a"].component("Comment",m["default"]),o["a"].component("AddItem",p["default"]);var v={name:"PurchaseOrderDisplay",components:{SupplierInfos:h["default"],CartItem:f["default"],AddItem:p["default"],Comment:m["default"]},data:function(){return{originalOrder:null,currentOrder:null,allItems:[],allComments:[],disableValidate:!0,loaded:!1,reportObject:null,isClosed:!1,supplierInfoBox:!1,orderIncomplete:!1}},methods:{getPurchaseOrder:function(){var e=this;return i()(regeneratorRuntime.mark((function t(){var r,s,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$q.loading.show(),t.next=3,e.requestOrder();case 3:for(e.$q.loading.hide(),e.allItems=Array.from(JSON.parse(e.currentOrder.line_items)),r=0,s=0;s<e.allItems.length;s++)void 0===e.allItems[s].direct_product&&(r+=1);for(a=0,n=0;n<e.allItems.length;n++)void 0===e.allItems[n].direct_product&&(a+=e.allItems[n].quantity);e.currentOrder.total_items_ordered=r,e.currentOrder.total_products_ordered=a,e.checkPoMissingFields(),e.checkCartMissingFields(),e.allComments=[],e.currentOrder.hasOwnProperty("comments")&&(e.allComments=Array.from(JSON.parse(e.currentOrder.comments))),e.currentOrder.closed&&(e.isClosed=!0),e.$store.commit("mvpPicking/mutate_currentOrder",{order:{meta:{id:e.$store.state.mvpPicking.currentOrder.meta.id,index:e.$store.state.mvpPicking.currentOrder.meta.index},details:{name:e.currentOrder.clean_name,address_line_1:e.currentOrder.address_line_1,address_line_2:e.currentOrder.address_line_2,post_code:e.currentOrder.post_code,city:e.currentOrder.city,contact_name:e.currentOrder.sales_contact_name,contact_email:e.currentOrder.sales_contact_email,contact_phone:e.currentOrder.sales_phone_number,status:e.currentOrder.status,number:e.currentOrder.number,supplier_id:e.currentOrder.supplier_id,type:e.currentOrder.type,picker:e.currentOrder.picker,expected_date:e.currentOrder.expected_date,total_items_ordered:r,total_products_ordered:a,total_items_received:e.currentOrder.total_items_received,total_products_received:e.currentOrder.total_products_received,comments:e.allComments},cart:{line_items:e.allItems}}}),e.loaded=!0;case 18:case"end":return t.stop()}}),t)})))()},requestOrder:function(){var e=this,t=this.$store.getters.apiurl+"generic/"+this.$store.state.mvpPicking.currentOrder.meta.index+"/"+this.$store.state.mvpPicking.currentOrder.meta.id+"?token="+this.$store.getters.creds.token;return l.a.get(t).then((function(t){e.originalOrder=Object.assign({},t.data.data._source),e.currentOrder=t.data.data._source})).catch((function(e){}))},sendOrderToServer:function(){this.checkOrderStatus(),this.currentOrder.updated_at=d()().format("YYYY-MM-DDTHH:mm:ss.SSSSSSZ"),this.currentOrder.line_items=JSON.stringify(this.allItems),this.currentOrder.comments=JSON.stringify(this.allComments);var e={_index:this.$store.state.mvpPicking.currentOrder.meta.index,_source:this.currentOrder,_id:this.$store.state.mvpPicking.currentOrder.meta.id};this.$store.commit({type:"updateRecord",data:e}),this.$q.notify({message:"Bon de commande sauvegardé",timeout:2e3,color:"green"});var t={_index:"pickupapp_log",_source:{id:this.$store.state.mvpPicking.currentOrder.meta.id,date:d()(),user:this.$store.getters.creds.user.login,current_order:this.currentOrder,original_order:this.originalOrder,type:"save_po"},_id:this.$store.state.mvpPicking.currentOrder.meta.id+"_"+d()().unix()};return this.$store.commit({type:"updateRecord",data:t}),!0},backToList:function(){var e=this;return i()(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=50,!e.hasPurchaseOrderChanged()){t.next=5;break}return t.next=4,e.sendOrderToServer();case 4:r=1500;case 5:setTimeout((function(){e.$root.$emit("displayListEvent")}),r);case 6:case"end":return t.stop()}}),t)})))()},onReceivedModified:function(e){var t=this;return i()(regeneratorRuntime.mark((function r(){var s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.allItems[e.index].received=e.new_received,s=JSON.parse(JSON.stringify(t.allItems)),t.allItems=null,t.allItems=s,t.isOrderComplete();case 5:case"end":return r.stop()}}),r)})))()},validateOrder:function(){var e=this;return i()(regeneratorRuntime.mark((function t(){var r,s,a,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.isOrderComplete()){t.next=4;break}e.orderIncomplete=!0,t.next=20;break;case 4:for(e.currentOrder.status="fully_collected",r=0,s=0;s<e.allItems.length;s++)r+=1;for(a=0,n=0;n<e.allItems.length;n++)a+=e.allItems[n].received;return e.currentOrder.total_items_received=r,e.currentOrder.total_products_received=a,t.next=13,e.isThereSomethingToReport();case 13:return i=t.sent,i&&e.prepareForSlack(),e.currentOrder.closed=!0,t.next=18,e.sendOrderToServer();case 18:e.$q.notify({message:"Bon de commande validé",timeout:3e3,color:"green"}),setTimeout((function(){e.$root.$emit("displayListEvent")}),500);case 20:case"end":return t.stop()}}),t)})))()},hasPurchaseOrderChanged:function(){return this.currentOrder.line_items=JSON.stringify(this.allItems),this.currentOrder.comments=JSON.stringify(this.allComments),JSON.stringify(this.currentOrder)!=JSON.stringify(this.originalOrder)},checkPoMissingFields:function(){this.currentOrder.hasOwnProperty("closed")||(this.currentOrder.closed=!1),this.currentOrder.hasOwnProperty("cart_complete")||(this.currentOrder.cart_complete=2),this.currentOrder.hasOwnProperty("has_dlc")||(this.currentOrder.has_dlc=!1),this.currentOrder.hasOwnProperty("dlc_date")||(this.currentOrder.dlc_date=""),this.currentOrder.hasOwnProperty("comments")||(this.currentOrder.comments=JSON.stringify(new Array)),this.currentOrder.hasOwnProperty("total_items_received")||(this.currentOrder.total_items_received=0),this.currentOrder.hasOwnProperty("total_products_received")||(this.currentOrder.total_products_received=0)},checkCartMissingFields:function(){for(var e=0;e<this.allItems.length;e++)this.allItems[e].hasOwnProperty("received")||(this.allItems[e].received=""),this.allItems[e].hasOwnProperty("dlc")&&(this.allItems[e].dlc_date="")},onAddComment:function(e){this.allComments.push(e)},onDeleteComment:function(e){for(var t=0;t<this.allComments.length;t++)this.allComments[t].msg===e.msg&&this.allComments.splice(t,1)},checkOrderStatus:function(){for(var e=null,t=0,r=0;r<this.allItems.length;r++)void 0===this.allItems[r].direct_product&&(t++,""===this.allItems[r].received?e+=0:this.allItems[r].received===this.allItems[r].quantity?e+=1:this.allItems[r].received<this.allItems[r].quantity?e+=2:this.allItems[r].received>this.allItems[r].quantity&&(e+=1));0===e?(this.currentOrder.cart_complete=2,this.currentOrder.status="to_be_collected"):e===t?(this.currentOrder.cart_complete=1,this.currentOrder.status="fully_collected"):(this.currentOrder.cart_complete=0,this.currentOrder.status="partially_collected")},isOrderComplete:function(){for(var e=!0,t=0;t<this.allItems.length;t++)!0===this.allItems[t].direct_product?0===this.allItems[t].received&&(e=!1):""===this.allItems[t].received&&(e=!1);return e},onProductAdded:function(e){for(var t=!1,r=0;r<this.allItems.length;r++)this.allItems[r].full_title===e.data&&(t=!0);if(!t){var s={full_title:e.data,product_id:null,quantity:0,received:0,variant_id:null,direct_product:!0};this.allItems.push(s)}},onDeleteItem:function(e){this.allItems.splice(e.index,1)},isThereSomethingToReport:function(){var e=!1;this.reportObject={less:[],more:[],new:[]};for(var t=0;t<this.allItems.length;t++)this.allItems[t].received<this.allItems[t].quantity&&(this.reportObject.less.push({title:this.allItems[t].full_title,quantity:this.allItems[t].quantity,received:this.allItems[t].received}),e=!0);for(t=0;t<this.allItems.length;t++)this.allItems[t].received>this.allItems[t].quantity&&!0!==this.allItems[t].direct_product&&(this.reportObject.more.push({title:this.allItems[t].full_title,quantity:this.allItems[t].quantity,received:this.allItems[t].received}),e=!0);for(t=0;t<this.allItems.length;t++)this.allItems[t].received>this.allItems[t].quantity&&!0===this.allItems[t].direct_product&&(this.reportObject.new.push({title:this.allItems[t].full_title,quantity:this.allItems[t].quantity,received:this.allItems[t].received}),e=!0);return e},prepareForSlack:function(){var e={};e.date=d()(),e.user=this.$store.getters.creds.user.firstname,e.apiUrl=this.$store.getters.apiurl,e.apiKey=this.$store.getters.activeApp.config.restApiKey,e.type="problem",e.supplier=this.currentOrder.supplier,e.problems=this.reportObject,e.poType=this.currentOrder.type,this.sendToSlack(e)},sendToSlack:function(e){var t=this;return i()(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.$store.dispatch("mvp/sendMessageToSlack",e);case 3:t.$q.notify({message:"Message envoyé !",timeout:5e3,color:"green"}),r.next=9;break;case 6:r.prev=6,r.t0=r["catch"](0),t.$q.notify({message:"Un problème est survenu, veuillez re-essayer plus tard.",timeout:5e3,color:"red"});case 9:case"end":return r.stop()}}),r,null,[[0,6]])})))()},modifyClosed:function(){var e=this;this.$q.dialog({title:"Confirmez svp",message:"Voulez-vous vraiment modifier ce bon déjà validé ?",cancel:!0,persistent:!0}).onOk((function(){e.currentOrder.closed=!1,e.isClosed=!1}))},onDlcModified:function(e){this.allItems[e.index].dlc_date=e.new_dlcDate,this.allItems[e.index].has_dlc=!0,this.currentOrder.has_dlc=!0},onDlcDeleted:function(e){this.allItems[e.index].dlc_date="",this.allItems[e.index].has_dlc=!1,this.currentOrder.has_dlc=!1},onCloseWindow:function(){this.supplierInfoBox=!1}},created:function(){},beforeMount:function(){},mounted:function(){this.getPurchaseOrder()},computed:{labelMenu:function(){return this.$store.getters["mvp/screenSize"].windowWidth<600?"":void 0===this.currentOrder.clean_name?this.currentOrder.supplier:this.currentOrder.clean_name},labelLeft:function(){return this.$store.getters["mvp/screenSize"].windowWidth<600?"":"retour"},labelRight:function(){return this.$store.getters["mvp/screenSize"].windowWidth<600?"":"valider"},labelRightM:function(){return this.$store.getters["mvp/screenSize"].windowWidth<600?"":"modifier"},showAddItem:function(){return!(!this.loaded||this.currentOrder.closed)}}},_=v,g=(r("6644"),r("2877")),b=r("1c1c"),y=r("de5e"),x=r("9c40"),q=r("24e8"),O=r("f09f"),w=r("a370"),k=r("54e1"),C=r("4b7e"),P=r("7f67"),S=r("eebe"),I=r.n(S),$=Object(g["a"])(_,s,a,!1,null,null,null);t["default"]=$.exports;I()($,"components",{QList:b["a"],QPageSticky:y["a"],QBtn:x["a"],QDialog:q["a"],QCard:O["a"],QCardSection:w["a"],QBanner:k["a"],QCardActions:C["a"]}),I()($,"directives",{ClosePopup:P["a"]})},"23dd":function(e,t,r){},"2f39":function(e,t,r){"use strict";r.r(t);r("ac1f"),r("5319"),r("96cf");var s=r("c973"),a=r.n(s),n=(r("7d6e"),r("e54f"),r("35fc"),r("9f29"),r("573e"),r("4439"),r("4605"),r("f580"),r("5b2b"),r("8753"),r("2967"),r("7e67"),r("d770"),r("dd82"),r("922c"),r("d7fb"),r("a533"),r("c32e"),r("a151"),r("8bc7"),r("e80f"),r("5fec"),r("e42f"),r("57fc"),r("d67f"),r("880e"),r("1c10"),r("9482"),r("e797"),r("4848"),r("53d0"),r("63b1"),r("e9fd"),r("195c"),r("64e9"),r("33c5"),r("4f62"),r("0dbc"),r("7c38"),r("0756"),r("4953"),r("81db"),r("2e52"),r("22485"),r("7797"),r("12a1"),r("ce96"),r("70ca"),r("2318"),r("24bd"),r("8f27"),r("3064"),r("c9a2"),r("8767"),r("4a8e"),r("b828"),r("3c1c"),r("21cb"),r("c00e"),r("e4a8"),r("e4d3"),r("f4d9"),r("fffd"),r("f645"),r("639e"),r("34ee"),r("b794"),r("af24"),r("7c9c"),r("7bb2"),r("64f7"),r("c382"),r("053c"),r("c48f"),r("f5d1"),r("3cec"),r("c00ee"),r("d450"),r("ca07"),r("14e3"),r("9393"),r("9227"),r("1dba"),r("674a"),r("de26"),r("6721"),r("9cb5"),r("ed9b"),r("fc83"),r("98e5"),r("605a"),r("ba60"),r("df07"),r("7903"),r("e046"),r("58af"),r("7713"),r("0571"),r("3e27"),r("6837"),r("3fc9"),r("0693"),r("bf41"),r("62f2"),r("7e6d"),r("2b0e")),i=r("b05d"),o=r("4d5a"),c=r("e359"),l=r("9404"),u=r("09e3"),d=r("9989"),p=r("65c6"),m=r("6ac5"),f=r("9c40"),h=r("0016"),v=r("27f9"),_=r("1c1c"),g=r("66e5"),b=r("8572"),y=r("4074"),x=r("ee89"),q=r("b047"),O=r("ddd8"),w=r("daf4"),k=r("9564"),C=r("52ee"),P=r("ca78"),S=r("f09f"),I=r("a370"),$=r("eb85"),j=r("714f"),D=r("f449"),M=r("12c5"),Q=r("2a19"),L=r("436b"),T=r("f508"),F=r("b12a");n["a"].use(i["a"],{config:{loading:{delay:0},capacitor:{backButtonExit:!1,backButton:!1},cordova:{backButtonExit:!1,backButton:!0},brand:{primary:"#70B937",secondary:"#26A69A",accent:"#9C27B0",dark:"#465451",positive:"#67C23A",negative:"orange",info:"#909399",warning:"#E6A23C"}},components:{QLayout:o["a"],QHeader:c["a"],QDrawer:l["a"],QPageContainer:u["a"],QPage:d["a"],QToolbar:p["a"],QToolbarTitle:m["a"],QBtn:f["a"],QIcon:h["a"],QInput:v["a"],QList:_["a"],QItem:g["a"],QField:b["a"],QItemSection:y["a"],QUploader:x["a"],QChip:q["a"],QSelect:O["a"],QRating:w["a"],QToggle:k["a"],QDate:C["a"],QTime:P["a"],QCard:S["a"],QCardSection:I["a"],QSeparator:$["a"]},directives:{Ripple:j["a"],TouchHold:D["a"],TouchSwipe:M["a"]},plugins:{Notify:Q["a"],Dialog:L["a"],Loading:T["a"],AppFullscreen:F["a"]}});var N=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"q-app"}},[r("router-view"),e.isOffline?r("div",{staticStyle:{position:"fixed","z-index":"10000",top:"0px",width:"100%"}},[r("q-banner",{staticClass:"bg-red text-white",attrs:{"inline-actions":"",rounded:""}},[e._v("\n      L'appareil n'est pas connecté à internet. L'application est hors ligne.\n    ")])],1):e._e()],1)},R=[],A=(r("d3b7"),r("e6cf"),r("bc3a")),E=r.n(A),Y=(r("2ef0"),r("bf4e")),z=r.n(Y);n["a"].use(z.a);var B={name:"App",data:function(){return{noNetworkNotif:null,axiosInterceptor:null}},watch:{},methods:{enableInterceptor:function(){var e=this;console.log("enable interceptors axios"),this.axiosInterceptor=E.a.interceptors.request.use((function(t){return e.isOffline?(console.log("NO NETWORK"),Promise.reject("NO NETWORK")):t}),(function(e){return Promise.reject(e)})),E.a.interceptors.response.use((function(t){return null!=t.data&&null!=t.data.error&&"UNKNOWN_TOKEN"==t.data.error?(console.warn("UNKNOWN_TOKEN"),"/"!=e.$route.path&&e.logoutDebounce(!0)):null!=t.data&&null!=t.data.error&&""!=t.data.error&&e.$notify({title:"Error",message:t.data.error,type:"error",position:"bottom-right"}),t}),(function(e){return console.error("response interceptor error ",e),Promise.reject(e)}))},disableInterceptor:function(){E.a.interceptors.request.eject(this.axiosInterceptor)}},mounted:function(){console.log("mounted"),null==this.axiosInterceptor&&this.enableInterceptor()},beforeDestroy:function(){this.disableInterceptor()}},J=B,U=r("2877"),W=r("54e1"),V=r("eebe"),H=r.n(V),K=Object(U["a"])(J,N,R,!1,null,null,null),X=K.exports;H()(K,"components",{QBanner:W["a"]});var Z=r("2f62"),G=r("c1df"),ee=r.n(G),te=(r("1276"),{namespaced:!0,state:{timer:5,targetDate:{dateFrom:"",dateTo:"",dateFromShort:"",dateToShort:""},screenSize:{windowHeight:"",windowWidth:"",appWidth:"",appHeight:""},slack_api_key:""},getters:{targetDate:function(e){return e.targetDate},screenSize:function(e){return e.screenSize},timer:function(e){return e.timer},slackKey:function(e){return e.slack_api_key}},mutations:{mutate_screenSize:function(e,t){e.screenSize=t.data},mutate_targetDate:function(e,t){e.targetDate=t.dateObj}},actions:{sendMessageToSlack:function(e,t){return a()(regeneratorRuntime.mark((function r(){var s,a,n,i,o,c,l,u,d,p,m,f,h,v,_,g,b,y,x;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:for(e.commit,s="","",a="",n="",i="Valentin:<@U01EUB7H38A>",o=[],o.push({user:i.split(":")[0],id:i.split(":")[1]}),c=0;c<o.length;c++)c===o.length-1?o[c].id:o[c].id+" ";if(l=null,"PO-NYX"!==t.poType&&(l=t.poType),"direct"===t.type?(n="#appro",a="Message de "+t.user,s="[ "+t.user+" | "+ee()(t.date).format("DD/MM/YYYY")+" ]\n"+t.msg):"po"===t.type?(n="#appro",a="Tournée de ramassage : "+t.supplier,s="[ "+t.user+" | "+t.supplier+" | ",null!==l&&(s+=l+" | "),s+=ee()(t.date).format("DD/MM/YYYY")+" ]\n"+t.msg):"problem"===t.type&&(n="#ramassage",a="Tournée de ramassage : problème reporté",s="[ "+t.user+" | "+t.supplier+" | ",null!==l&&(s+=l+" | "),s+=ee()(t.date).format("DD/MM/YYYY")+" ]"),u=[{type:"header",text:{type:"plain_text",text:a}},{type:"section",text:{type:"mrkdwn",text:"mentionned"}},{type:"section",text:{type:"plain_text",text:s}}],"problem"===t.type){if(t.problems.less.length>0)for(u.push({type:"divider"}),d={type:"section",text:{type:"mrkdwn",text:"*Il manque des produits :*"}},u.push(d),p=0;p<t.problems.less.length;p++)m={type:"section",text:{type:"mrkdwn",text:"*Produit :* "+t.problems.less[p].title+"\n*Quantité reçue :* "+t.problems.less[p].received+" / "+t.problems.less[p].quantity}},u.push(m);if(t.problems.more.length>0)for(u.push({type:"divider"}),f={type:"section",text:{type:"mrkdwn",text:"*Il a des produits en surplus :*"}},u.push(f),h=0;h<t.problems.more.length;h++)v={type:"section",text:{type:"mrkdwn",text:"*Produit :* "+t.problems.more[h].title+"\n*Quantité reçue :* "+t.problems.more[h].received+" / "+t.problems.more[h].quantity}},u.push(v);if(t.problems.new.length>0)for(u.push({type:"divider"}),_={type:"section",text:{type:"mrkdwn",text:"*Il y a des produits non commandé :*"}},u.push(_),g=0;g<t.problems.new.length;g++)b={type:"section",text:{type:"mrkdwn",text:"*Produit :* "+t.problems.new[g].title+"\n*Quantité reçue :* "+t.problems.new[g].received+" / "+t.problems.new[g].quantity}},u.push(b);u.push({type:"divider"})}return y={channel:n,blocks:u},x=t.apiUrl+"lambdas/4/publish_to_slack?apikey="+t.apiKey,r.abrupt("return",E.a.post(x,y));case 17:case"end":return r.stop()}}),r)})))()}}}),re=(r("4de4"),r("b0c0"),r("466d"),r("1b3f"),{namespaced:!0,state:{serverUrl:"https://app.nyx-mvp.ovh/api/v1",apiUrl:"/lambdas/4/save_line_items",apiKey:"PREPKEY_39864873684",lock_dry:!1,lock_fresh:!1,orders:[],itemsClicked:0,itemsClickedFresh:0,itemsClickedDry:0,currentOrder:null,currentItem:{},currentOrderItems:[],modeFilter:"all",currentOrderPreparedItems:null,updated_items:null,displayedItems:[],openFinishedOrders:!1,scrollView:!1},mutations:{mutate_scrollView:function(e,t){e.scrollView=t},mutate_openFinishedOrders:function(e,t){e.openFinishedOrders=t},mutate_displayedItems:function(e,t){e.displayedItems=t},mutate_itemsClicked:function(e,t){e.itemsClicked=t},mutate_itemsClickedFresh:function(e,t){e.itemsClickedFresh=t},mutate_itemsClickedDry:function(e,t){e.itemsClickedDry=t},mutate_allOrders:function(e,t){e.orders=t},mutate_currentOrderItems:function(e,t){e.currentOrderItems=t},mutate_currentOrder:function(e,t){e.currentOrder=t},mutate_currentItem:function(e,t){e.currentItem=t},mutate_preparedItems:function(e,t){e.currentOrderPreparedItems=t},mutate_updated_items:function(e,t){e.updated_items=t},mutate_lockDry:function(e,t){e.lock_dry=t},mutate_lockFresh:function(e,t){e.lock_fresh=t},mutate_modeFilter:function(e,t){localStorage.modeFilter=t,e.modeFilter=t}},actions:{getOrderItems:function(e){var t=e.state,r=e.commit,s=e.rootState;T["a"].show({delay:100});s.mvp;var a=s.apiurl,n={size:5e3,sort:[{date:{order:"desc",unmapped_type:"boolean"}}],_source:{},query:{bool:{must:[],filter:[{bool:{should:[{match:{order:""}}],minimum_should_match:1}},{bool:{must_not:[{match:{isKit:!0}}]}}],should:[],must_not:[]}}},i="mvp_app_line_item";n.query.bool.filter[0].bool.should[0].match.order="#"+t.currentOrder._source.order_number.replace("#",""),a+="generic_search/"+i,a+="?token="+s.creds.token,E.a.post(a,n).then((function(e){if(T["a"].hide(),""!==e.data.error)console.error("Get products error...");else{e.data.records.sort((function(e,t){return e._source.loc>t._source.loc?1:e._source.loc<t._source.loc?-1:e._source.name>t._source.name?1:e._source.name<t._source.name?-1:0}));var t=e.data.records;for(var s in t)void 0===t[s]._source.prep_status&&(t[s]._source.prep_status="");t.sort((function(e,t){return""===e._source.prep_status||""===t._source.prep_status?""!==t._source.prep_status?-1:1:"manq"===e._source.prep_status||"manq"===t._source.prep_status?"manq"!==t._source.prep_status?-1:1:"remb"===e._source.prep_status?"remb"!==t._source.prep_status?-1:1:void 0})),r("mutate_currentOrderItems",t)}})).catch((function(e){T["a"].hide(),e.response?(console.log(e.response.data),console.log(e.response.status),console.log(e.response.headers)):e.request?console.log(e.request):console.log("Error",e.message)}))},requestOrder:function(e,t){var r=e.state,s=e.rootState;T["a"].show({delay:300});var a=s.apiurl+"generic/mvp_app_order/"+t+"?token="+s.creds.token;return E.a.get(a).then((function(e){T["a"].hide();var t=e.data.data;r.currentOrder=t,void 0===t._source.dryItems&&(t._source.lock=!1,t._source.prep_status="")})).catch((function(e){}))},updateOrderItems:function(e,t){var r=e.state,s=e.commit;T["a"].show({delay:300});var a=r.serverUrl+r.apiUrl+"?apikey="+r.apiKey;E.a.post(a,t).then((function(e){T["a"].hide(),""!==e.data.error?console.error("Send line items error..."):s("mutate_updated_items",e.data.records)})).catch((function(e){console.error(e)}))},getOrders:function(e){e.state;var t=e.rootState,r=e.commit,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;T["a"].show({delay:2e3});var a="mvp_app_order",n=t.mvp,i={size:5e3,sort:[{date:{order:"desc",unmapped_type:"boolean"}}],_source:{},query:{bool:{must:[{range:{date:{gte:"",lte:""}}}]}}};null===s?(i.query.bool.must[0].range.date.gte=n.targetDate.dateFrom,i.query.bool.must[0].range.date.lte=n.targetDate.dateTo):(i.query.bool.must[0].range.date.gte=s.dateFrom,i.query.bool.must[0].range.date.lte=s.dateTo);var o=t.apiurl+"generic_search/"+a+"?token="+t.creds.token;E.a.post(o,i).then((function(e){T["a"].hide();var t=e.data.records;for(var s in t)void 0==t[s]._source.courier&&(t[s]._source.courier_index=-1);r("mutate_allOrders",t)})).catch((function(e){T["a"].hide()}))},updateOrder:function(e,t){e.state;var r=e.rootState,s=r.apiurl+"generic/"+t.data._index+"/"+t.data._id+"?token="+r.creds.token;E.a.post(s,t.data._source).then((function(e){""!==e.data.error?console.log("save object error"):console.log("save object success")})).catch((function(e){console.log(e)}))},sendMessageToSlack:function(e,t){return a()(regeneratorRuntime.mark((function r(){var s,a,n,i,o,c,l,u;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:for(e.commit,s="","","",a="",n="Valentin:<@U01EUB7H38A>",i=[],i.push({user:n.split(":")[0],id:n.split(":")[1]}),o=0;o<i.length;o++)o===i.length-1?i[o].id:i[o].id+" ";return null,"PO-NYX"!==t.poType&&t.poType,"direct"===t.type&&(a="#prepa","Message de "+t.user,s="Commande *#"+t.order+"* ("+t.user+")  \n"+t.msg),c=[{type:"section",text:{type:"mrkdwn",text:s}}],c.push({type:"divider"}),l={channel:a,blocks:c},u=t.apiUrl+"lambdas/4/publish_to_slack?apikey="+t.apiKey,r.abrupt("return",E.a.post(u,l));case 17:case"end":return r.stop()}}),r)})))()}},getters:{currentOrder:function(e){return e.currentOrder},modeFilter:function(e){return e.modeFilter},orders:function(e){return e.orders},orderItems:function(e){return e.currentOrderItems},preparedItems:function(e){return e.currentOrderPreparedItems},lock:function(e){return e.currentOrder._source.lock},freshItems:function(e){return e.currentOrderItems.filter((function(e){return e._source.fresh||e._source.frais}))},dryItems:function(e){return e.currentOrderItems.filter((function(e){return!(e._source.fresh||e._source.frais)}))}}}),se={namespaced:!0,state:{currentOrder:{currentOrder:{meta:{id:"",index:""},details:{},cart:{}}},allPurchaseOrders:{}},getters:{currentOrder:function(e){return e.currentOrder},getOrderDetails:function(e){return e.currentOrder.details},allPurchaseOrders:function(e){return e.allPurchaseOrders}},mutations:{mutate_currentOrder:function(e,t){e.currentOrder=t.order},mutate_allPurchaseOrders:function(e,t){e.allPurchaseOrders=t.data}}};n["a"].use(Z["a"]);var ae=function(){var e=new Z["a"].Store({modules:{mvp:te,mvpPrep:re,mvpPicking:se},state:{version:"v1.0.3",apiurl:"https://app.nyx-mvp.ovh/api/v1/",menus:[],apps:[],currentApps:null,activeApp:null,privileges:[],filteredmenus:[],creds:{},maintitle:"",appName:"mobile"},getters:{version:function(e){return e.version},appName:function(e){return e.appName},apiurl:function(e){return e.apiurl},creds:function(e){return e.creds},privileges:function(e){return e.privileges},filteredmenus:function(e){return e.filteredmenus},currentApps:function(e){return e.currentApps},activeApp:function(e){return e.activeApp},menus:function(e){return e.menus},maintitle:function(e){return e.maintitle}},actions:{privileges:function(e){var t=e.commit,r=e.state,s=r.apiurl+"generic_search/nyx_privilege?token="+r.creds.token;E.a.post(s,{size:1e3}).then((function(e){""!=e.data.error?console.log("Privileges error..."):(console.log("Privileges success..."),t("privileges",e.data.records))})).catch((function(e){console.log(e)}))},filters:function(e){var t=e.commit,r=e.state,s=r.apiurl+"generic_search/nyx_filter?token="+r.creds.token;E.a.post(s,{}).then((function(e){""!=e.data.error?console.log("Filters error..."):(console.log("Filters success..."),t("filters",e.data.records))})).catch((function(e){console.log(e)}))}},mutations:{filters:function(e,t){e.filters=t},privileges:function(e,t){e.privileges=t},login:function(e,t){for(var r in console.log("Login mutation called."),e.initialized=!1,e.creds=t.data.cred,e.menus=t.data.menus,e.apps=[],t.data.menus){var s=t.data.menus[r];if("apps"==s.category&&void 0!=s.submenus&&s.submenus.length>0)for(var a in s.submenus)e.apps=s.submenus[a].apps}e.filteredmenus=[];var n=e.menus;for(var i in n)if("apps"!=n[i].category){var o=[];for(var c in n[i].submenus){var l=[];for(var u in n[i].submenus[c].apps){var d=n[i].submenus[c].apps[u].type;"form"!=d&&"free-text"!=d&&"internal"!=d||l.push(n[i].submenus[c].apps[u])}l.length>0&&(n[i].submenus[c].apps=JSON.parse(JSON.stringify(l)),o.push(JSON.parse(JSON.stringify(n[i].submenus[c]))))}o.length>0&&(n[i].submenus=JSON.parse(JSON.stringify(o)),e.filteredmenus.push(n[i]))}e.currentApps=e.filteredmenus[0].submenus[0],e.activeApp=e.filteredmenus[0].submenus[0].apps[0],e.maintitle=e.filteredmenus[0].submenus[0].loc_title,e.maintitleicon=e.filteredmenus[0].submenus[0].icon,console.log("Login mutation done.")},logout:function(e){var t=e.apiurl+"cred/logout?token="+e.creds.token;E.a.get(t).then((function(e){""!=e.data.error?console.log("Logout error..."):console.log("Logout success...")})).catch((function(e){console.log(e)}))},changeApps:function(e,t){console.log("VUEX:CURRENT APP:"),console.log(JSON.stringify(t.data)),e.currentApps=t.data,e.maintitle=t.data.loc_title,e.maintitleicon=t.data.icon,e.timeRangeVisible=t.data.apps[0].timeSelectorChecked},changeApp:function(e,t){console.log("changeApp mutation called.");for(var r=null,s=0;s<e.filteredmenus.length;s++){for(var a=e.filteredmenus[s],i=0;i<a.submenus.length;i++){for(var o=a.submenus[i],c=0;c<o.apps.length;c++)if(o.apps[c].rec_id===t.data){r=o.apps[c],e.currentSubCategory=o;break}if(null!==r)break}if(null!==r)break}e.maintitle=e.currentSubCategory.loc_title,e.activeApp=null,e.activeApp=r,console.log(r),null!=r.timeDefault&&""!=r.timeDefault&&(console.log("send forcetime"),n["a"].prototype.$globalbus.$emit("forcetime",r.timeDefault),console.log("send forcetime"))},updateRecord:function(e,t){var r=e.apiurl+"generic/"+t.data._index+"/"+t.data._id+"?token="+e.creds.token;E.a.post(r,t.data._source).then((function(e){""!=e.data.error?console.log("Save object error..."):console.log("Save object success...")})).catch((function(e){console.log(e)}))},sendMessage:function(e,t){console.log("Send Message");var r=e.apiurl+"sendmessage?token="+e.creds.token,s={destination:""+t.data.destination,body:t.data.message};E.a.post(r,s).then((function(e){""!=e.data.error&&console.log("Unable to send message")})).catch((function(e){console.log(e)}))}}});return e},ne=r("8c4f"),ie=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-layout",{staticClass:"bg-grey-1"},[r("div",{staticClass:"login-container"},[r("q-input",{staticClass:"login-input",attrs:{error:e.$v.form.login.$error,"float-label":"Login",disable:e.loading,clearable:""},on:{blur:e.$v.form.login.$touch,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}},model:{value:e.form.login,callback:function(t){e.$set(e.form,"login",t)},expression:"form.login"}}),r("q-input",{staticClass:"password-input",attrs:{type:"password",error:e.$v.form.password.$error,"float-label":"Password",disable:e.loading,clearable:""},on:{blur:e.$v.form.password.$touch,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}}),r("q-btn",{staticClass:"login-button",attrs:{color:"primary",rounded:"",size:"lg",outline:"",loading:e.loading},on:{click:e.submit}},[e._v("Login")])],1)])},oe=[],ce=r("b5ae"),le={data:function(){return{form:{login:"",password:""},loading:!1}},validations:{form:{login:{required:ce["required"]},password:{required:ce["required"]}}},methods:{submit:function(){if(this.$v.form.$touch(),this.$v.form.$error)return this.$q.notify({message:"Unable to authenticate.",type:"negative",position:"bottom",closeBtn:!0,timeout:500}),void(this.loading=!1);this.validateUser()},validateUser:function(){var e=this;return a()(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,console.log(e.$store.getters.apiurl),t.next=5,E.a.post(e.$store.getters.apiurl+"cred/login",{login:e.form.login,password:e.form.password,app:e.$store.getters.appName});case 5:r=t.sent,""==r.data.error?e.authenticate(r):(e.$q.notify({message:r.data.error,type:"negative",position:"bottom",closeBtn:!0,timeout:500}),e.loading=!1),t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](1),e.loading=!1,console.log(t.t0);case 13:e.loading=!1;case 14:case"end":return t.stop()}}),t,null,[[1,9]])})))()},authenticate:function(e){localStorage.authResponse=JSON.stringify(e),this.$i18n.locale=e.data.cred.user.language,e.data.cred.user.user=this.form.login,this.$store.commit({type:"login",data:e.data});var t=this.$store.getters.activeApp.rec_id;this.$store.commit({type:"changeApp",data:t});var r="/main/"+t;console.log("pushing path",r),this.$router.push(r),this.$q.notify({title:this.$t("notifications.message"),message:this.$t("notifications.welcome")+" v("+e.data.version+"/v1.0)",type:"positive",position:"bottom",timeout:500}),this.form.login="",this.form.password="",this.$store.dispatch("privileges"),this.$store.dispatch("filters")}},mounted:function(){var e={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(t,r,s){e[r]=s})),void 0!=e["api"]&&(this.$store.state.apiurl=e["api"].split("#")[0])}},ue=le,de=(r("da41"),r("57d9"),r("b498")),pe=Object(U["a"])(ue,ie,oe,!1,null,"83f0a7ea",null),me=pe.exports;H()(pe,"components",{QLayout:o["a"],QInput:v["a"],QBtn:f["a"],QColor:de["a"]});var fe=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-layout",[r("q-header",[r("q-toolbar",[r("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"menu"},on:{click:function(t){e.showLeft=!e.showLeft}}}),r("q-toolbar-title",[e._v("\n        "+e._s(e.title)+"\n        "),r("span",{attrs:{slot:"subtitle"},slot:"subtitle"},[e._v(e._s(e.maintitle))])])],1)],1),r("q-drawer",{ref:"mainDrawer",attrs:{overlay:"",behavior:"mobile",side:"left"},model:{value:e.showLeft,callback:function(t){e.showLeft=t},expression:"showLeft"}},[r("div",{staticClass:"bg-brown-1 account-container"},[r("q-icon",{staticClass:"account-icon",attrs:{size:"80px",name:"account_circle",color:"green"}}),e.creds&&e.creds.user?r("div",{staticClass:"user-info"},[r("small",{staticClass:"text-bold lowercase text-black block"},[e._v(e._s(e.creds.user.firstname)+" "+e._s(e.creds.user.lastname))]),r("small",{staticClass:"text text-grey-7 block"},[e._v(e._s(e.creds.user.user))]),r("small",{staticClass:"logout-button text-bold lowercase text-black block"},[e._v(e._s(e.$store.getters.version))])]):e._e(),r("q-btn",{staticClass:"pwd-button",attrs:{rounded:"",outline:"",color:"negative",size:"sm",label:"Logout"},on:{click:function(t){return e.clickLogout()}}})],1),r("q-list",{attrs:{"no-border":"",link:"","inset-separator":""}},e._l(e.filteredmenus,(function(t,s){return r("span",{key:s},[r("q-item-label",{attrs:{header:""}},[e._v(e._s(t.loc_category))]),e._l(t.submenus,(function(t,s){return r("q-item",{key:s,attrs:{to:"/main/"+t.apps[0].rec_id},nativeOn:{click:function(r){return e.appClicked(t)}}},["form"==t.apps[0].type?r("q-item-section",{attrs:{avatar:"",icon:"insert_drive_file"}}):r("q-item-section",{attrs:{avatar:""}},[r("q-icon",{attrs:{name:"school"}})],1),r("q-item-section",[e._v(e._s(t.loc_title))])],1)}))],2)})),0)],1),r("q-page-container",[r("router-view")],1)],1)},he=[],ve=(r("caad"),r("2532"),{name:"home",data:function(){return{title:"NYX Mobile",showLeft:!1}},computed:{apiurl:function(){return this.$store.getters.apiurl},creds:function(){return this.$store.getters.creds},menus:function(){return this.$store.getters.menus},maintitle:function(){if(this.$store.getters.activeApp)return this.$store.getters.activeApp.title},filteredmenus:function(){return this.$store.getters.filteredmenus}},methods:{clickLogout:function(){var e=this;this.$q.dialog({title:"Warning",message:"Are you sure you want to logout ?",color:"negative",ok:!0,cancel:!0}).onOk((function(){e.logout()})).catch((function(){}))},logout:function(){console.log("BEFCOMMIT"),this.$store.commit({type:"logout",data:{}}),console.log("AFTERCOMMIT"),this.$q.notify({title:this.$t("notifications.message"),message:this.$t("notifications.bye"),type:"positive",position:"bottom",timeout:500}),this.$router.push("/")},appClicked:function(e){"external"==e.type&&window.open(e.config.url),this.$refs.mainDrawer.hide()}},created:function(){var e=a()(regeneratorRuntime.mark((function e(){var t,r,s,a,n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t={},window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(e,r,s){t[r]=s})),void 0!=t["api"]&&(this.$store.state.apiurl=t["api"].split("#")[0]),void 0!=this.$store.getters.currentSubCategory||!localStorage.authResponse){e.next=19;break}return r=this.$route.path,"/"==r[r.length-1]&&(r=r.substring(0,r.length-1)),s=r.replace("/main/",""),a=JSON.parse(localStorage.authResponse),n=this.$store.getters.apiurl+"status?token="+a.data.cred.token,e.prev=9,e.next=12,E.a.get(n);case 12:i=e.sent,200==i.status&&""==i.data.error&&(this.$store.commit({type:"login",data:a.data}),this.$store.commit({type:"changeApp",data:s}),a.data.cred.user.privileges.includes("admin")&&(this.$store.commit({type:"privileges",data:a.data.all_priv}),this.$store.commit({type:"filters",data:a.data.all_filters}))),e.next=19;break;case 16:e.prev=16,e.t0=e["catch"](9),console.log(e.t0);case 19:case"end":return e.stop()}}),e,this,[[9,16]])})));function t(){return e.apply(this,arguments)}return t}(),mounted:function(){},beforeDestroy:function(){}}),_e=ve,ge=(r("4012"),r("0170")),be=Object(U["a"])(_e,fe,he,!1,null,"c0d5bd14",null),ye=be.exports;H()(be,"components",{QLayout:o["a"],QHeader:c["a"],QToolbar:p["a"],QBtn:f["a"],QToolbarTitle:m["a"],QDrawer:l["a"],QIcon:h["a"],QList:_["a"],QItemLabel:ge["a"],QItem:g["a"],QItemSection:y["a"],QPageContainer:u["a"]});var xe=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.activeApp?r("div",["form"==e.activeApp.type?r("div",[r("Form",{attrs:{config:e.activeApp}})],1):r("div",[r(e.activeApp.config.controller,{tag:"component",attrs:{config:e.activeApp}})],1)]):e._e()},qe=[],Oe=(r("4160"),r("e260"),r("159b"),r("ddb0"),r("ded3")),we=r.n(Oe),ke=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"form-container"},[e._l(e.formModel,(function(t){return r("q-field",{key:t.field,attrs:{label:e.computeTranslatedText(t.title,e.$store.getters.creds.user.language)}},["string"==t.type?r("q-input",{attrs:{type:t.subtype,color:t.color,inverted:t.inverted,clearable:t.clearable},model:{value:t.value,callback:function(r){e.$set(t,"value",r)},expression:"item.value"}}):e._e(),"number"==t.type?r("q-input",{attrs:{type:t.type,color:t.color,inverted:t.inverted,clearable:t.clearable},model:{value:t.value,callback:function(r){e.$set(t,"value",r)},expression:"item.value"}}):e._e(),"datetime"==t.type?r("q-datetime",{attrs:{color:t.color,inverted:t.inverted,type:t.subtype},model:{value:t.value,callback:function(r){e.$set(t,"value",r)},expression:"item.value"}}):e._e(),"uploader"==t.type?r("q-uploader",{attrs:{color:t.color,inverted:t.inverted,url:t.value}}):e._e(),"chips"==t.type?r("q-chips-input",{attrs:{color:t.color,inverted:t.inverted},model:{value:t.value,callback:function(r){e.$set(t,"value",r)},expression:"item.value"}}):e._e(),"boolean"==t.type?r("q-toggle",{attrs:{color:t.color,inverted:t.inverted},model:{value:t.value,callback:function(r){e.$set(t,"value",r)},expression:"item.value"}}):e._e(),"rating"==t.type?r("q-rating",{attrs:{color:t.color,inverted:t.inverted,max:t.maxRating},model:{value:t.value,callback:function(r){e.$set(t,"value",r)},expression:"item.value"}}):e._e(),"selecter"==t.type?r("q-select",{attrs:{options:t.selectOptions,color:t.color,inverted:t.inverted,multiple:t.multiple},model:{value:t.value,callback:function(r){e.$set(t,"value",r)},expression:"item.value"}}):e._e()],1)})),r("div",{staticClass:"button-box"},[r("q-btn",{staticClass:"send-form-button",attrs:{color:"primary",size:"lg",outline:"",loading:e.loading},on:{click:e.submit}},[e._v("Send")]),r("q-btn",{staticClass:"send-form-button",attrs:{color:"negative",size:"lg",outline:"",disable:e.loading},on:{click:e.reset}},[e._v("Reset")])],1)],2)},Ce=[];r("fb6a"),r("8a79"),r("2ca0");function Pe(e,t){if(void 0==e)return"";if(!e.startsWith("@")||!e.endsWith("@"))return e;var r=e.substring(1,e.length-1).split(";"),s={};return r.forEach((function(e){var t=e.split("=");t.length>0&&(s[t[0]]=t[1])})),void 0!=s[t]?s[t]:r}n["a"].filter("formatDate",(function(e){if(e)return ee()(String(e)).format("DD/MM")})),n["a"].filter("dateShort",(function(e){if(e)return ee()(String(e)).format("DD/MM")})),n["a"].filter("dateClassic",(function(e){if(e)return ee()(String(e)).format("DD/MM/YYYY")})),n["a"].filter("dateFrench",(function(e){if(e)return ee.a.locale("fr"),ee()(String(e)).format("DD MMMM YYYY")})),n["a"].filter("uppercaseFirst",(function(e){if(e)return e.charAt(0).toUpperCase()+e.slice(1)})),n["a"].filter("onlyTime",(function(e){if(e)return ee.a.locale("fr"),ee()(String(e)).format("HH:mm")}));var Se=r("ebfd"),Ie=r.n(Se);n["a"].use(Ie.a);var $e={name:"Form",data:function(){return{formLabelWidth:"120px",chips:["abc"],inverted:!0,loading:!1,formModel:null}},props:{config:{type:Object}},computed:{configin:function(){return this.config}},watch:{configin:function(){this.prepareData()}},created:function(){this.prepareData()},methods:{computeTranslatedText:function(e,t){return Pe(e,t)},prepareData:function(){for(var e in console.log("prepare data"),this.formModel=JSON.parse(JSON.stringify(this.config.config.headercolumns)),console.log("prepare data"),console.log(JSON.stringify(this.config.config.headercolumns)),this.formModel){var t=this.formModel[e];if("chips"==t.type)t.value=[];else if("uploader"==t.type)t.value="";else if("string"==t.type)t.value="";else if("boolean"==t.type)t.value=!1;else if("number"==t.type)t.value=0;else if("rating"==t.type)t.value=0;else if("datetime"==t.type)t.subType="datetime",t.value=ee.a.now();else if("selecter"==t.type){for(var e in t.selectOptions){var r={label:t.selectOptions[e],value:t.selectOptions[e]};t.selectOptions[e]=r}t.multiple?t.value=[]:t.value=""}else t.value=null;null==t.color&&(t.color="light"),null==t.inverted&&(t.inverted=!0)}var s=JSON.parse(JSON.stringify(this.formModel));this.formModel={},this.formModel=s},reset:function(){this.prepareData()},submit:function(){var e=this;this.loading=!0;var t={_index:this.config.config.index,_source:{},_id:"id_"+Math.floor(16777216*(1+Math.random()))+"_"+Math.floor(16777216*(1+Math.random()))};for(var r in this.formModel){var s=this.formModel[r];t["_source"][s.field]=s.value}t["_source"]["@timestamp"]=ee()(),this.$getLocation({enableHighAccuracy:!1}).then((function(r){t._source.location=[r["lng"],r["lat"]],t._source.user=e.$store.getters.creds.user.user;var s="table";void 0!=e.config.config.formmode&&(s=e.config.config.formmode),"table"==s?e.$store.commit({type:"updateRecord",data:t}):e.$store.commit({type:"sendMessage",data:{destination:e.config.config.destination,message:JSON.stringify(t._source)}}),e.$q.notify({title:"saved",message:"Saved",type:"positive",position:"bottom",timeout:500}),e.prepareData(),e.loading=!1})).catch((function(t){alert(t),e.loading=!1}))}}},je=$e,De=(r("a82c"),Object(U["a"])(je,ke,Ce,!1,null,"49fcdbea",null)),Me=De.exports;H()(De,"components",{QField:b["a"],QInput:v["a"],QDate:C["a"],QUploader:x["a"],QChip:q["a"],QToggle:k["a"],QRating:w["a"],QSelect:O["a"],QBtn:f["a"]});var Qe=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{"text-align":"left"}},[r("h1",[e._v("Free text 3")]),r("span",{domProps:{innerHTML:e._s(e.config.config.freetext)}})])},Le=[],Te={name:"FreeText",data:function(){return{}},props:{config:{type:Object}},methods:{},created:function(){},mounted:function(){},beforeDestroy:function(){clearInterval(this.timer)}},Fe=Te,Ne=Object(U["a"])(Fe,Qe,Le,!1,null,null,null),Re=Ne.exports;n["a"].component("Form",Me),n["a"].component("FreeText",Re);var Ae=r("92d5"),Ee={};Ae.keys().forEach((function(e){var t="".concat(e.split(".")[1].split("/")[e.split(".")[1].split("/").length-1]),r=Ae(e).default;Ee[t]=r}));var Ye={data:function(){return{selectedTab:"TAB-0",loading:!1}},components:we()({},Ee),watch:{$route:function(e,t){var r=this;t.params.recid!==e.params.recid&&(this.loading=!0,this.$store.commit({type:"changeApp",data:this.$route.params.recid}),this.$nextTick((function(){return r.loading=!1})))}},computed:{activeApp:function(){return this.$store.getters.activeApp},currentApps:function(){return this.$store.getters.currentApps}},methods:{handleTabClick:function(e){}},mounted:function(){},destroyed:function(){},updated:function(){console.log("**********  Updated:")}},ze=Ye,Be=Object(U["a"])(ze,xe,qe,!1,null,null,null),Je=Be.exports,Ue=(r("7adf"),r("00e0"),[{path:"/",name:"Login",component:me},{path:"/main",name:"Main",component:ye,children:[{path:":recid",name:"GenericComponent",component:Je}]}]);Ue.push({path:"*",component:function(){return r.e(2).then(r.bind(null,"e51e"))}});var We=Ue;n["a"].use(ne["a"]);var Ve=function(){var e=new ne["a"]({scrollBehavior:function(){return{y:0}},routes:We,mode:"hash",base:""});return e},He=function(){return Ke.apply(this,arguments)};function Ke(){return Ke=a()(regeneratorRuntime.mark((function e(){var t,r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("function"!==typeof ae){e.next=6;break}return e.next=3,ae({Vue:n["a"]});case 3:e.t0=e.sent,e.next=7;break;case 6:e.t0=ae;case 7:if(t=e.t0,"function"!==typeof Ve){e.next=14;break}return e.next=11,Ve({Vue:n["a"],store:t});case 11:e.t1=e.sent,e.next=15;break;case 14:e.t1=Ve;case 15:return r=e.t1,t.$router=r,s={router:r,store:t,render:function(e){return e(X)}},s.el="#q-app",e.abrupt("return",{app:s,store:t,router:r});case 20:case"end":return e.stop()}}),e)}))),Ke.apply(this,arguments)}var Xe=r("a925"),Ze={failed:"Action failed",success:"Action was successful",notifications:{message:"message",bye:"bye bye",welcome:"welcome"}},Ge={"en-us":Ze},et=function(e){var t=e.app,r=e.Vue;r.use(Xe["a"]),t.i18n=new Xe["a"]({locale:"en-us",fallbackLocale:"en-us",messages:Ge})},tt=function(e){var t=e.Vue;t.prototype.$axios=E.a},rt=r("1dce"),st=r.n(rt),at=function(e){var t=e.Vue;t.use(st.a)},nt=(r("a0db"),"");function it(){return ot.apply(this,arguments)}function ot(){return ot=a()(regeneratorRuntime.mark((function e(){var t,r,s,a,i,o,c,l,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,He();case 2:t=e.sent,r=t.app,s=t.store,a=t.router,i=!1,o=function(e){i=!0;var t=Object(e)===e?a.resolve(e).route.fullPath:e;window.location.href=t},c=window.location.href.replace(window.location.origin,""),l=[et,tt,at],u=0;case 11:if(!(!1===i&&u<l.length)){e.next=29;break}if("function"===typeof l[u]){e.next=14;break}return e.abrupt("continue",26);case 14:return e.prev=14,e.next=17,l[u]({app:r,router:a,store:s,Vue:n["a"],ssrContext:null,redirect:o,urlPath:c,publicPath:nt});case 17:e.next=26;break;case 19:if(e.prev=19,e.t0=e["catch"](14),!e.t0||!e.t0.url){e.next=24;break}return window.location.href=e.t0.url,e.abrupt("return");case 24:return console.error("[Quasar] boot error:",e.t0),e.abrupt("return");case 26:u++,e.next=11;break;case 29:if(!0!==i){e.next=31;break}return e.abrupt("return");case 31:document.addEventListener("deviceready",(function(){n["a"].prototype.$q.cordova=window.cordova,new n["a"](r)}),!1);case 32:case"end":return e.stop()}}),e,null,[[14,19]])}))),ot.apply(this,arguments)}it()},"3e33":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-pull-to-refresh",{on:{refresh:e.refresh}},[r("q-list",{staticClass:"flex row"},e._l(e.ordersSorted,(function(e,t){return r("OrderCard",{key:t,attrs:{order:e,id:e._id}})})),1)],1)},a=[],n=(r("c740"),r("caad"),r("ac1f"),r("2532"),r("1276"),r("96cf"),r("c973")),i=r.n(n),o=r("ded3"),c=r.n(o),l=r("715d"),u=r("2f62"),d={name:"OrdersList",props:["ordersToShow"],data:function(){return{interval:null}},computed:c()(c()({},Object(u["c"])("mvpPrep",["modeFilter","openFinishedOrders","currentOrder","scrollView"])),{},{ordersSorted:function(){var e=this.ordersToShow.sort((function(e,t){return e._id-t._id})).sort((function(e,t){return e._source.tags.split(",").includes(" express")&&!t._source.tags.split(",").includes(" express")?-1:1}));return"fresh"===this.modeFilter?e.sort((function(e,t){return e._source.courier_index-t._source.courier_index})):e}}),components:{OrderCard:l["default"]},methods:{refresh:function(e){this.$store.dispatch("mvpPrep/getOrders"),e()},nextOrder:function(e){var t=this.ordersSorted.findIndex((function(t){return t._id===e._id}));return t<this.ordersSorted.length-1?this.ordersSorted[t+1]:this.ordersSorted[0]}},updated:function(){if(null!==this.currentOrder&&this.scrollView){var e=this.nextOrder(this.currentOrder),t=document.getElementById("".concat(e._id));t.classList.add("highlight"),t.scrollIntoView({behavior:"smooth",block:"center"}),this.$store.commit("mvpPrep/mutate_scrollView",!1),setTimeout((function(){return t.classList.remove("highlight")}),3e3)}},mounted:function(){var e=this,t=1e3*this.$store.getters["mvp/timer"];setTimeout((function(){e.$store.dispatch("mvpPrep/getOrders"),e.interval=setInterval(i()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$store.dispatch("mvpPrep/getOrders");case 2:case"end":return e.stop()}}),e,this)}))).bind(e),t)}),500)},beforeDestroy:function(){clearInterval(this.interval)}},p=d,m=(r("56ac"),r("2877")),f=r("59d7"),h=r("1c1c"),v=r("eebe"),_=r.n(v),g=Object(m["a"])(p,s,a,!1,null,"45f3f584",null);t["default"]=g.exports;_()(g,"components",{QPullToRefresh:f["a"],QList:h["a"]})},4012:function(e,t,r){"use strict";var s=r("b34d"),a=r.n(s);a.a},"43b9":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"row q-pa-xs"},[r("div",{staticClass:"col-xs-12 col-sm-6 q-pa-sm"},[r("q-list",{attrs:{bordered:"",separator:""}},[r("q-item",[r("q-item-section",[e._v("\n            Produits frais :\n          ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n            "+e._s(e.currentOrderItems.filter((function(e){return e._source.fresh||e._source.frais})).length)+"\n          ")])],1),r("q-item",[r("q-item-section",[e._v("\n            Produits secs :\n          ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n            "+e._s(e.currentOrderItems.filter((function(e){return!(e._source.fresh||e._source.frais)})).length)+"\n          ")])],1),r("q-item",[r("q-item-section",[e._v("\n            Nombre total de produits :\n          ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n            "+e._s(e.currentOrderItems.length)+"\n          ")])],1),r("q-item",[r("q-item-section",[e._v("\n            Poids total en kg:\n          ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n            "+e._s(e.currentOrder._source.tot_weight_kg)+"\n          ")])],1),r("q-item",[r("q-item-section",[e._v("\n            Compost :\n          ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n            "+e._s(e.currentOrder._source.compost?"Oui":"Non")+"\n          ")])],1)],1)],1),r("div",{staticClass:"col-xs-12 col-sm-6 q-pa-sm"},[r("q-list",{attrs:{bordered:"",separator:""}},[r("q-item",[r("q-item-section",[e._v("\n            Addresse :\n          ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n            "+e._s(e.currentOrder._source.addr1)),r("br"),e._v("\n            "+e._s(e.currentOrder._source.zip)+" "+e._s(e.currentOrder._source.city)+"\n          ")])],1),r("q-item",[r("q-item-section",[e._v("\n            Zone :\n          ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n            "+e._s(e.currentOrder._source.zone)+"\n          ")])],1)],1)],1)]),r("div",{staticClass:"row q-pa-xs"},[r("div",{staticClass:"col-xs-12 col-sm-6 q-pa-sm"},[r("q-list",{attrs:{bordered:"",separator:""}},[r("q-item",[r("q-item-section",[e._v("\n            Préparés secs :\n          ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n            "+e._s(e.currentOrderItems.filter((function(e){return!(e._source.fresh||e._source.frais)&&"success"===e._source.prep_status})).length)+"/"+e._s(e.currentOrderItems.filter((function(e){return!(e._source.fresh||e._source.frais)})).length)+"\n          ")])],1),r("q-item",[r("q-item-section",[e._v("\n            Préparés frais :\n          ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n            "+e._s(e.currentOrderItems.filter((function(e){return(e._source.fresh||e._source.frais)&&"success"===e._source.prep_status})).length)+"/"+e._s(e.currentOrderItems.filter((function(e){return e._source.fresh||e._source.frais})).length)+"\n          ")])],1)],1)],1),r("div",{staticClass:"col-xs-12 col-sm-6 q-pa-sm"},[r("q-list",{attrs:{bordered:"",separator:""}},[r("q-item",[r("q-item-section",[e._v("\n            À rembourser secs :\n          ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n            "+e._s(e.currentOrderItems.filter((function(e){return!(e._source.fresh||e._source.frais)&&"remb"===e._source.prep_status})).length)+"/"+e._s(e.currentOrderItems.filter((function(e){return!(e._source.fresh||e._source.frais)})).length)+"\n          ")])],1),r("q-item",[r("q-item-section",[e._v("\n            À rembourser frais :\n          ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n            "+e._s(e.currentOrderItems.filter((function(e){return(e._source.fresh||e._source.frais)&&"remb"===e._source.prep_status})).length)+"/"+e._s(e.currentOrderItems.filter((function(e){return e._source.fresh||e._source.frais})).length)+"\n          ")])],1)],1)],1),r("div",{staticClass:"col-xs-12 col-sm-6 q-pa-sm"},[r("q-list",{attrs:{bordered:"",separator:""}},[r("q-item",[r("q-item-section",[e._v("\n            Manquants secs :\n          ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n            "+e._s(e.currentOrderItems.filter((function(e){return!(e._source.fresh||e._source.frais)&&"manq"===e._source.prep_status})).length)+"/"+e._s(e.currentOrderItems.filter((function(e){return!(e._source.fresh||e._source.frais)})).length)+"\n          ")])],1),r("q-item",[r("q-item-section",[e._v("\n            Manquants frais :\n          ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n            "+e._s(e.currentOrderItems.filter((function(e){return(e._source.fresh||e._source.frais)&&"manq"===e._source.prep_status})).length)+"/"+e._s(e.currentOrderItems.filter((function(e){return e._source.fresh||e._source.frais})).length)+"\n          ")])],1)],1)],1),r("div",{staticClass:"col-xs-12 col-sm-6 q-pa-sm"},[r("q-list",{attrs:{bordered:"",separator:""}},[r("q-item",[r("q-item-section",[e._v("\n            Remplacés secs :\n          ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n            "+e._s(e.currentOrderItems.filter((function(e){return!(e._source.fresh||e._source.frais)&&"replaced"===e._source.prep_status})).length)+"/"+e._s(e.currentOrderItems.filter((function(e){return!(e._source.fresh||e._source.frais)})).length)+"\n          ")])],1),e._l(e.replacedDry,(function(t,s){return r("q-item",{key:t._id+s},[r("q-item-section",[e._v(" "+e._s(t._source.name))]),r("q-item-section",[e._v("\n            "+e._s("Remplacé par : "+t._source.replacement))])],1)}))],2)],1),r("div",{staticClass:"col-xs-12 col-sm-6 q-pa-sm"},[r("q-list",{attrs:{bordered:"",separator:""}},[r("q-item",[r("q-item-section",[e._v("\n            Remplacés frais :\n          ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n            "+e._s(e.currentOrderItems.filter((function(e){return(e._source.fresh||e._source.frais)&&"replaced"===e._source.prep_status})).length)+"/"+e._s(e.currentOrderItems.filter((function(e){return e._source.fresh||e._source.frais})).length)+"\n          ")])],1),e._l(e.replacedFresh,(function(t,s){return r("q-item",{key:t._id+s},[r("q-item-section",[e._v(" "+e._s(t._source.name))]),r("q-item-section",[e._v("\n            "+e._s("Remplacé par : "+t._source.replacement))])],1)}))],2)],1),r("div",{staticClass:"col-xs-12 col-sm-6 q-pa-sm"},[r("q-list",{attrs:{bordered:"",separator:""}},[r("q-item",[r("q-item-section",[e._v("\n            Préparateur :\n          ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n            "+e._s(e.currentOrder._source.preparateur)+"\n          ")])],1)],1)],1)])])},a=[],n=(r("4de4"),r("ded3")),i=r.n(n),o=r("2f62"),c={name:"OrderInfos",computed:i()(i()({},Object(o["c"])("mvpPrep",["currentOrder","currentOrderItems"])),{},{replacedFresh:function(){return this.currentOrderItems.filter((function(e){return(e._source.fresh||e._source.frais)&&"replaced"===e._source.prep_status}))},replacedDry:function(){return this.currentOrderItems.filter((function(e){return!(e._source.fresh||e._source.frais)&&"replaced"===e._source.prep_status}))}})},l=c,u=r("2877"),d=r("eb85"),p=r("1c1c"),m=r("66e5"),f=r("4074"),h=r("eebe"),v=r.n(h),_=Object(u["a"])(l,s,a,!1,null,"0f39d8d4",null);t["default"]=_.exports;v()(_,"components",{QSeparator:d["a"],QList:p["a"],QItem:m["a"],QItemSection:f["a"]})},4580:function(e,t,r){},4678:function(e,t,r){var s={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function a(e){var t=n(e);return r(t)}function n(e){if(!r.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}a.keys=function(){return Object.keys(s)},a.resolve=n,e.exports=a,a.id="4678"},"47e8":function(e,t,r){},"56ac":function(e,t,r){"use strict";var s=r("ff5b"),a=r.n(s);a.a},"57d9":function(e,t,r){"use strict";var s=r("c9fc"),a=r.n(s);a.a},"588f":function(e,t,r){"use strict";var s=r("dad6"),a=r.n(s);a.a},"58d1":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("transition",{attrs:{"enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOutDown",duration:"100"}},[e.prepa?e._e():r("q-item",{directives:[{name:"touch-hold",rawName:"v-touch-hold:300.mouse",value:function(){return e.replace=!0},expression:"() => (replace = true)",arg:"300",modifiers:{mouse:!0}}],class:["bg-"+e.bgColor+"-2","item q-pa-none"],attrs:{clickable:"",dense:""},on:{click:function(t){return e.changeStatus(e.product,"success")}}},[void 0!==e.product._source.smallImage?r("q-item-section",{staticStyle:{"max-width":"60px"}},[r("img",{staticStyle:{width:"60px",height:"60px"},attrs:{src:e.product._source.smallImage}})]):r("q-item-section",{staticStyle:{"max-width":"60px"}},[r("img",{staticStyle:{width:"60px",height:"60px"},attrs:{src:"https://via.placeholder.com/50"}})]),r("div",{staticClass:"flex row col-xs-10"},[r("div",{staticClass:"row col-xs-12 items-center"},[r("div",{staticClass:" row col-xs-10 justify-start q-px-xs",staticStyle:{"font-weight":"bold","font-size":"15px"}},[r("span",{staticClass:" text-dark"},[e._v(e._s(e.product._source.name))])]),r("div",{staticClass:"row col-xs-2 justify-end"},[r("q-badge",{class:[e.isFrais?"frais":"sec","justify-center"],staticStyle:{"max-width":"40px"}},[e._v("\n            "+e._s(this.isFrais?"Frais":"Sec")+"\n          ")])],1)]),r("div",{staticClass:"row full-width items-center text-grey-6"},[r("q-icon",{attrs:{name:"location_on"}}),r("div",{staticClass:" row col-xs-6 col-md-9 justify-start"},[r("span",{staticClass:"overflow-ellipsis"},[e._v("\n            LOC "+e._s(e.product._source.loc)+" | "+e._s(e.product._source.clean_vendor)+"\n          ")])]),r("div",{staticClass:"row col-xs-5 col-md-2 justify-end"},[r("q-btn",{staticStyle:{color:"white","max-width":"40px","margin-bottom":"5px"},attrs:{icon:"close",color:"red-4",size:"15px",unelevated:"",rounded:""},on:{click:function(t){return t.stopPropagation(),e.changeStatus(e.product,"remb")}}}),e._v("\n             \n          "),r("q-btn",{staticStyle:{color:"white","max-width":"40px","margin-left":"20px","margin-bottom":"5px"},attrs:{icon:"hourglass_bottom",color:"orange-4",size:"15px",unelevated:"",rounded:""},on:{click:function(t){return t.stopPropagation(),e.changeStatus(e.product,"manq")}}})],1)],1)]),r("q-dialog",{attrs:{"full-width":""},model:{value:e.replace,callback:function(t){e.replace=t},expression:"replace"}},[r("q-card",{staticClass:"q-pa-xs"},[r("q-card-section",{staticClass:"row items-center"},[r("div",{staticClass:"dialog-box-title"},[e._v("\n            Indiquer le produit de remplacement\n          ")])]),r("q-card-section",{staticClass:"row flex-center"},[r("q-input",{staticClass:"full-width",attrs:{filled:"",type:"textarea"},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}})],1),r("q-card-actions",{attrs:{align:"right"}},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Annuler",color:"primary"}}),r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Valider",color:"primary"},on:{click:function(t){return e.replaceItem(e.product)}}})],1)],1)],1)],1)],1)},a=[],n=(r("c975"),r("d81d"),r("a434"),r("ded3")),i=r.n(n),o=r("c1df"),c=r.n(o),l=r("2f62"),u={name:"OrderItem",props:["product"],data:function(){return{prepa:!1,replace:!1,message:""}},computed:i()(i()({},Object(l["c"])("mvpPrep",["itemsClicked","itemsClickedFresh","itemsClickedDry","modeFilter","displayedItems","currentOrderItems"])),{},{prepStatus:function(){return this.product._source.prep_status},isFrais:function(){return this.product._source.fresh||this.product._source.frais},bgColor:function(){return"remb"===this.product._source.prep_status?"red":"manq"===this.product._source.prep_status?"orange":"success"===this.product._source.prep_status?"green":"replaced"===this.product._source.prep_status?"blue":void 0},history:function(){return this.product._source.history}}),methods:{replaceItem:function(e){e._source.replacement=this.message,this.changeStatus(e,"replaced")},addToHistory:function(e){this.history?this.product._source.history.push({status:e,date:c()().format("DD/MM/YYYY HH:mm:ss"),user:this.$store.getters.creds.user.firstname}):this.product._source.history=[{status:e,date:c()().format("DD/MM/YYYY HH:mm:ss"),user:this.$store.getters.creds.user.firstname}]},changeStatus:function(e,t){var r=this;this.prepa=!0,this.incrementClick(e),this.addToHistory(t),this.$set(this.product._source,"prep_status",t),this.$emit("prep",e),setTimeout((function(){r.prepa=!1,r.putFirstItemLast(e)}),300)},putFirstItemLast:function(e){var t=JSON.parse(JSON.stringify(this.currentOrderItems)),r=t.map((function(e){return e._id})).indexOf(e._id);t.push(t.splice(r,1)[0]),this.$store.commit("mvpPrep/mutate_currentOrderItems",t)},incrementClick:function(e){""===e._source.prep_status&&("all"===this.modeFilter?this.$store.commit("mvpPrep/mutate_itemsClicked",this.itemsClicked+1):"fresh"===this.modeFilter?(this.$store.commit("mvpPrep/mutate_itemsClickedFresh",this.itemsClickedFresh+1),this.$store.commit("mvpPrep/mutate_itemsClicked",this.itemsClicked+1)):"dry"===this.modeFilter&&(this.$store.commit("mvpPrep/mutate_itemsClickedDry",this.itemsClickedDry+1),this.$store.commit("mvpPrep/mutate_itemsClicked",this.itemsClicked+1)))}}},d=u,p=(r("f2f1"),r("2877")),m=r("66e5"),f=r("4074"),h=r("58a8"),v=r("0016"),_=r("9c40"),g=r("24e8"),b=r("f09f"),y=r("a370"),x=r("27f9"),q=r("4b7e"),O=r("f449"),w=r("7f67"),k=r("eebe"),C=r.n(k),P=Object(p["a"])(d,s,a,!1,null,"db499dbc",null);t["default"]=P.exports;C()(P,"components",{QItem:m["a"],QItemSection:f["a"],QBadge:h["a"],QIcon:v["a"],QBtn:_["a"],QDialog:g["a"],QCard:b["a"],QCardSection:y["a"],QInput:x["a"],QCardActions:q["a"]}),C()(P,"directives",{TouchHold:O["a"],ClosePopup:w["a"]})},"59ea":function(e,t,r){"use strict";var s=r("47e8"),a=r.n(s);a.a},6339:function(e,t,r){},6644:function(e,t,r){"use strict";var s=r("76b2"),a=r.n(s);a.a},6849:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-card",{staticClass:"q-pa-xs"},[r("q-card-section",{staticClass:"row items-center"},[r("div",{staticClass:"dialog-box-title"},[e._v("\n      Modifier la quantité\n    ")])]),r("q-card-section",{staticClass:"row flex-center"},[r("q-btn",{directives:[{name:"touch-repeat",rawName:"v-touch-repeat:0:150.mouse.enter.space",value:e.removeQty,expression:"removeQty",arg:"0:150",modifiers:{mouse:!0,enter:!0,space:!0}}],attrs:{round:"",color:"primary",size:"xl",icon:"remove"}}),r("div",{staticClass:"qty-nbr"},[r("h2",[e._v(e._s(e.modifiedQuantity))])]),r("q-btn",{directives:[{name:"touch-repeat",rawName:"v-touch-repeat:0:150.mouse.enter.space",value:e.addQty,expression:"addQty",arg:"0:150",modifiers:{mouse:!0,enter:!0,space:!0}}],attrs:{round:"",color:"primary",size:"xl",icon:"add"}})],1),e.warningBanner?r("q-card-section",{staticClass:"row flex-center"},[r("q-banner",{staticClass:"text-white bg-red",attrs:{"inline-actions":""},scopedSlots:e._u([{key:"avatar",fn:function(){return[r("q-icon",{attrs:{name:"warning",color:"white"}})]},proxy:!0}],null,!1,894313219)},[r("b",[e._v("La quantité reçue est supérieure à la quantité commandée.")])])],1):e._e(),r("q-card-actions",{attrs:{align:"right"}},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Annuler",color:"primary"}}),r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Valider",color:"primary"},on:{click:e.closeWindow}})],1)],1)},a=[],n=(r("a9e3"),{name:"QuantityAdjust",props:{quantity:{type:Number,required:!0},ordered:{type:Number,required:!0}},data:function(){return{modifiedQuantity:0}},methods:{addQty:function(){this.modifiedQuantity+=1},removeQty:function(){this.modifiedQuantity-=1,this.modifiedQuantity<0&&(this.modifiedQuantity=0)},updateData:function(){this.$emit("quantityModified",{data:this.modifiedQuantity})},closeWindow:function(){this.$emit("quantityModified",{data:this.modifiedQuantity}),this.$emit("closeWindow")}},mounted:function(){this.modifiedQuantity=this.quantity},computed:{warningBanner:function(){if(this.ordered>0)return this.modifiedQuantity>this.ordered}}}),i=n,o=(r("9aaf"),r("2877")),c=r("f09f"),l=r("a370"),u=r("9c40"),d=r("54e1"),p=r("0016"),m=r("4b7e"),f=r("35e7"),h=r("7f67"),v=r("eebe"),_=r.n(v),g=Object(o["a"])(i,s,a,!1,null,null,null);t["default"]=g.exports;_()(g,"components",{QCard:c["a"],QCardSection:l["a"],QBtn:u["a"],QBanner:d["a"],QIcon:p["a"],QCardActions:m["a"]}),_()(g,"directives",{TouchRepeat:f["a"],ClosePopup:h["a"]})},"693a":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-item",{staticClass:"q-pa-none"},[r("q-card",{class:e.cardConfig(),attrs:{square:"",flat:"",bordered:""}},[r("div",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"row full-height",attrs:{clickable:""},on:{click:e.onCardClick}},[r("div",{staticClass:"col-xs-2 col-sm-1 text-center date q-pa-sm"},[e._v("\n        "+e._s(e._f("dateShort")(e.expected_date))+"\n      ")]),r("div",{staticClass:"col"},[r("div",{staticClass:"row full-heigth justify-between"},[r("div",{staticClass:"col-xs-12 col-sm-9 name q-pa-sm full-heigth"},[e._v("\n            "+e._s(e._f("uppercaseFirst")(e.supplier))+"\n          ")]),r("div",{staticClass:"col-xs-12 col-sm-3 meta q-pa-sm full-heigth"},[r("OrderTags",{attrs:{closed:e.closed,cart_complete:e.cart_complete,has_dlc:e.has_dlc,comments:e.anyComments,has_direct:e.has_direct_product}})],1)])])])])],1)},a=[],n=(r("a630"),r("a9e3"),r("3ca3"),r("2b0e")),i=r("a4ac");n["a"].component("OrderTags",i["default"]);var o={name:"SupplierCard",props:{expected_date:{type:String,required:!0},supplier:{type:String,required:!0},type:{type:String,required:!0},status:{type:String,required:!0},number:{type:String,required:!0},id:{type:String,required:!0},index:{type:String,required:!0},closed:{type:Boolean,required:!0},cart_complete:{type:Number,required:!0},has_dlc:{type:Boolean,required:!0},units_ordered:{type:Number,required:!1},units_received:{type:Number,required:!1},comments:{type:String,required:!0},has_direct_product:{type:Boolean,required:!0}},data:function(){return{anyComments:!1}},methods:{onCardClick:function(){var e={id:this.id,index:this.index};this.$root.$emit("displayOrderEvent",e)},cardConfig:function(){return 0===this.cart_complete?"full-width q-py-sm bg-orange text-white":1===this.cart_complete?"full-width q-py-sm bg-green text-white":2===this.cart_complete?"full-width q-py-sm bg-white text-primary":void 0}},mounted:function(){var e=Array.from(JSON.parse(this.comments));e.length>0&&(this.anyComments=!0)}},c=o,l=(r("588f"),r("2877")),u=r("66e5"),d=r("f09f"),p=r("714f"),m=r("eebe"),f=r.n(m),h=Object(l["a"])(c,s,a,!1,null,null,null);t["default"]=h.exports;f()(h,"components",{QItem:u["a"],QCard:d["a"]}),f()(h,"directives",{Ripple:p["a"]})},"6d0e":function(e,t,r){},"6f51":function(e,t,r){"use strict";var s=r("2a19");t["a"]={created:function(){document.addEventListener("offline",(function(e){s["a"].create({message:"Vous n'êtes pas connecté à l'internet",timeout:5e3,color:"red",position:"center"})}),!1)}}},"70f4":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"header"},[e.open?r("span",{on:{click:function(t){t.stopPropagation(),e.open=!e.open}}},[e._v("\n      ▲     Fermer")]):e._e(),e.open?e._e():r("span",{on:{click:function(t){t.stopPropagation(),e.open=!e.open}}},[e._v("\n      ▼     Voir le status des produits")])]),e.open?e._t("default"):e._e()],2)},a=[],n={name:"CollapsibleSection",data:function(){return{open:!1}}},i=n,o=(r("f1a5"),r("2877")),c=Object(o["a"])(i,s,a,!1,null,"041f5522",null);t["default"]=c.exports},"713e":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-list",{staticClass:"q-pa-none q-ma-none",staticStyle:{"padding-bottom":"85px"},attrs:{separator:""}},e._l(e.sortedItemsList,(function(t,s){return r("OrderItem",{key:t._id+s,attrs:{product:t},on:{prep:e.addProductToPreparedItems}})})),1)},a=[],n=(r("4de4"),r("c740"),r("96cf"),r("c973")),i=r.n(n),o=r("448a"),c=r.n(o),l=r("ded3"),u=r.n(l),d=r("58d1"),p=r("2f62"),m={name:"OrderItems",props:["preparedProducts"],data:function(){return{componentKey:0}},computed:u()(u()(u()({},Object(p["c"])("mvpPrep",["displayedItems","currentOrderItems","modeFilter"])),Object(p["b"])("mvpPrep",["freshItems","dryItems"])),{},{sortedItemsList:function(){return"fresh"===this.modeFilter?this.freshItems:"dry"===this.modeFilter?this.dryItems:this.currentOrderItems}}),components:{OrderItem:d["default"]},methods:{addProductToPreparedItems:function(e){this.preparedProducts.filter((function(t){return t._id===e._id})).length>0?this.update(this.preparedProducts,e):(this.preparedProducts.push(e),this.$store.commit("mvpPrep/mutate_preparedItems",this.preparedProducts))},update:function(e,t){var r=e.findIndex((function(e){return e._id===t._id})),s=c()(e);s[r]=u()({},t),this.$store.commit("mvpPrep/mutate_preparedItems",s)}},watch:{modeFilter:{handler:function(){}}},beforeCreate:function(){var e=this;return i()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("mvpPrep/getOrderItems");case 2:case"end":return t.stop()}}),t)})))()}},f=m,h=r("2877"),v=r("1c1c"),_=r("eebe"),g=r.n(_),b=Object(h["a"])(f,s,a,!1,null,"25c993d3",null);t["default"]=b.exports;g()(b,"components",{QList:v["a"]})},"715d":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.order?r("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],class:[e.status,"bg-grey-11 row flex full-width"],staticStyle:{padding:"10px",margin:"0 0 10px 0"},attrs:{flat:"",clickable:""},on:{click:e.cardClick}},[r("q-item-section",{staticClass:"row flex col-xs-2 items-center",staticStyle:{"max-width":"60px"}},["finished"===e.order._source.prep_status?r("q-icon",{staticStyle:{"background-color":"white","font-size":"2.5rem",color:"green","border-radius":"40px",padding:"2px"},attrs:{left:"",name:"done"}}):e._e(),"started"===e.order._source.prep_status?r("q-icon",{staticStyle:{"background-color":"white","font-size":"2.5rem",color:"deepskyblue","border-radius":"40px",padding:"2px"},attrs:{left:"",name:"pending"}}):e._e(),"finishedWithRemb"===e.order._source.prep_status?r("q-icon",{staticStyle:{"background-color":"white",color:"red","border-radius":"40px","font-size":"2.5rem",padding:"2px"},attrs:{left:"",name:"close"}}):e._e(),"unfinished"===e.order._source.prep_status?r("q-icon",{staticStyle:{"background-color":"white","font-size":"2.5rem",color:"orange","border-radius":"40px",padding:"2px"},attrs:{left:"",name:"hourglass_bottom"}}):e._e(),"finishedWithReplaced"===e.order._source.prep_status?r("q-icon",{staticStyle:{"background-color":"white","font-size":"2.5rem",color:"dodgerblue","border-radius":"40px",padding:"2px"},attrs:{left:"",name:"published_with_changes"}}):e._e()],1),r("q-item-section",{staticClass:"text-subtitle1 row col-xs-10 justify-center",staticStyle:{margin:"0"}},[r("div",{staticClass:"full-width"},[r("b",[e._v("# "+e._s(e.order._source.order_number))]),r("q-chip",{staticClass:"float-right",attrs:{"text-color":"black",square:""}},[e._v("\n        "+e._s(e.order._source.tags.split(",").filter((function(e){return e.includes("-")}))[0])+"\n      ")]),e.order._source.tags.split(",").includes(" express")?r("q-chip",{staticClass:"float-right",attrs:{square:"",color:"blue","text-color":"white"}},[e._v("\n        express\n      ")]):e._e()],1),r("div",[e.order._source.intermediaryStatus&&"unfinished"===e.order._source.prep_status?r("q-chip",{attrs:{square:"",color:e.orderColor,"text-color":"white"}},[e._v("\n        Préparation "+e._s(e.order._source.intermediaryStatus)+" terminée\n      ")]):e._e(),"started"===e.order._source.prep_status?r("q-chip",{attrs:{square:"",color:e.orderColor,"text-color":"white"}},[e._v("\n        En cours de preparation\n        "+e._s("dry"===e.order._source.lock_type?"Sec":"fresh"===e.order._source.lock_type?"Frais":"")+"\n      ")]):r("q-chip",{attrs:{square:"",color:e.orderColor,"text-color":"white"}},[e._v("\n        "+e._s(e.order._source.prep_status?"finished"===e.order._source.prep_status?"Finie":"unfinished"===e.order._source.prep_status?"Non finie":"started"===e.order._source.prep_status?"Commencé":"finishedWithRemb"===e.order._source.prep_status?"Finie avec produits à rembourser":"finishedWithReplaced"===e.order._source.prep_status?"Finie avec produits remplacés":"":"Non préparé")+"\n      ")]),-1!==e.order._source.courier_index?r("q-chip",{attrs:{square:"",color:"blue","text-color":"white"}},[e._v("\n        "+e._s(e.order._source.courier.toLowerCase())+"\n      ")]):e._e()],1)])],1):e._e()},a=[],n=(r("96cf"),r("c973")),i=r.n(n),o=r("ded3"),c=r.n(o),l=r("70f4"),u=r("2f62"),d={name:"OrderCard",props:["order"],components:{CollapsibleSection:l["default"]},computed:c()(c()(c()({orderColor:function(){return"finishedWithRemb"===this.order._source.prep_status?"red":"unfinished"===this.order._source.prep_status?"orange":"finished"===this.order._source.prep_status?"green":"blue"},cardDisabled:function(){return this.order._source.lock}},Object(u["b"])(["creds"])),Object(u["c"])("mvpPrep",["lock_fresh","lock_dry","currentOrderItems","currentOrder","itemsClicked"])),{},{status:function(){return this.order._source.prep_status},userName:function(){return this.creds.user.firstname},blocker:function(){return this.order._source.blocker}}),methods:{cardClick:function(){var e=this;return i()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.cardDisabled){t.next=4;break}e.$q.dialog({title:"Lock",message:"Commande bloquée par ".concat(e.blocker,", voulez-vous continuer"),cancel:!0}).onOk((function(){e.$store.dispatch("mvpPrep/requestOrder",e.order._id).then((function(){e.$router.push({query:{showOrder:e.order._id}})}))})).onCancel((function(){})),t.next=11;break;case 4:return t.next=6,e.$store.dispatch("mvpPrep/requestOrder",e.order._id);case 6:if("started"!==e.currentOrder._source.prep_status){t.next=9;break}return alert("cette commande est en cours de préparation"),t.abrupt("return");case 9:return t.next=11,e.$router.push({query:{showOrder:e.order._id}});case 11:case"end":return t.stop()}}),t)})))()}}},p=d,m=(r("f6c3"),r("2877")),f=r("66e5"),h=r("4074"),v=r("0016"),_=r("b047"),g=r("714f"),b=r("eebe"),y=r.n(b),x=Object(m["a"])(p,s,a,!1,null,"602660c0",null);t["default"]=x.exports;y()(x,"components",{QItem:f["a"],QItemSection:h["a"],QIcon:v["a"],QChip:_["a"]}),y()(x,"directives",{Ripple:g["a"]})},"71ee":function(e,t,r){"use strict";var s=r("9c71"),a=r.n(s);a.a},"76b2":function(e,t,r){},"7adf":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-page",[e.urlOrderId?r("div",[r("ShowOrder",{attrs:{orderId:e.urlOrderId}})],1):e.urlOrderList?r("div",[r("div",{staticStyle:{"min-height":"400px","padding-top":"160px"}},[r("OrdersList",{attrs:{ordersToShow:e.ordersToDisplay}})],1),r("q-page-sticky",{staticClass:"bg-blue-grey-1 q-pt-md",attrs:{expand:"",position:"top"}},[r("div",{staticClass:"row full-width flex items-center q-px-lg"},[r("div",{staticClass:"col-4 justify-start items-center"},[r("q-btn",{staticClass:"bg-dark text-white",attrs:{icon:"arrow_back_ios",size:"md",unelevated:"",round:""},on:{click:e.goBackToDashboard}})],1),r("div",{staticClass:"row col-8 justify-end items-center"},[r("ItemsFilter")],1),r("div",{staticClass:"row col-8 justify-start items-center q-mt-md text-h6 text-dark"},[e._v("\n          "+e._s(e.ordersToDisplay.length)+" commandes\n        ")]),r("div",{staticClass:"row col-4 justify-end text-h6 text-dark q-mt-md"},[e._v("\n          "+e._s(e.userName)+"\n        ")])]),r("StickyBanner",{staticClass:"row full-width items-center q-pa-none",staticStyle:{height:"50px"}})],1),r("q-page-container",[r("router-view")],1)],1):r("div",{staticStyle:{"padding-top":"100px"}},[r("OrdersDashboard")],1)])},a=[],n=(r("4de4"),r("c975"),r("cca6"),r("ac1f"),r("5319"),r("1276"),r("96cf"),r("c973")),i=r.n(n),o=r("ded3"),c=r.n(o),l=r("d6b4"),u=r("00e0"),d=r("3e33"),p=r("9136"),m=r("2f62"),f=r("e26d"),h=r("6f51"),v={name:"MvpPrepOrders",mixins:[h["a"]],components:{OrdersDashboard:f["default"],OrdersList:d["default"],StickyBanner:l["default"],ItemsFilter:p["default"],ShowOrder:u["default"]},data:function(){return{products:[],indiceOrders:"mvp_app_order"}},computed:c()(c()(c()({},Object(m["b"])(["creds"])),Object(m["c"])("mvpPrep",["orders","openFinishedOrders"])),{},{urlOrderId:function(){var e=this.$route.fullPath;return e.indexOf("showOrder=")>-1?e.split("showOrder=")[1]:null},urlOrderList:function(){var e=this.$route.fullPath;return e.indexOf("ordersList")>-1||null},modeFilter:{get:function(){return this.$store.getters["mvpPrep/modeFilter"]},set:function(e){this.$store.commit("mvpPrep/mutate_modeFilter",e)}},userName:function(){return this.creds.user.firstname},targetDate:function(){return this.$store.getters["mvp/targetDate"]},ordersToDisplay:function(){var e;return"all"===this.modeFilter?(this.$store.commit("mvpPrep/mutate_lockDry",!1),this.$store.commit("mvpPrep/mutate_lockFresh",!1),e=this.orders.filter((function(e){return e._source.has_sec||e._source.has_frais}))):"dry"===this.modeFilter?(this.$store.commit("mvpPrep/mutate_lockDry",!0),e=this.orders.filter((function(e){return e._source.has_sec}))):"fresh"===this.modeFilter&&(this.$store.commit("mvpPrep/mutate_lockFresh",!0),e=this.orders.filter((function(e){return e._source.has_frais}))),this.openFinishedOrders?e.filter((function(e){return"finished"===e._source.prep_status||"finishedWithRemb"===e._source.prep_status||"finishedWithReplaced"===e._source.prep_status})):e}}),watch:{targetDate:{handler:function(){this.$store.dispatch("mvpPrep/getOrders").then((function(){}))},deep:!0}},methods:{goBackToDashboard:function(){var e=Object.assign({},this.$route.query);delete e.path,this.$router.replace({query:e})}},created:function(){var e=this;return i()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("mvpPrep/getOrders");case 2:case"end":return t.stop()}}),t)})))()},mounted:function(){var e=this;return i()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:localStorage.modeFilter&&(e.modeFilter=localStorage.modeFilter);case 1:case"end":return t.stop()}}),t)})))()}},_=v,g=(r("ea82"),r("2877")),b=r("9989"),y=r("de5e"),x=r("9c40"),q=r("09e3"),O=r("eebe"),w=r.n(O),k=Object(g["a"])(_,s,a,!1,null,null,null);t["default"]=k.exports;w()(k,"components",{QPage:b["a"],QPageSticky:y["a"],QBtn:x["a"],QPageContainer:q["a"]})},"7e6d":function(e,t,r){},"83ca":function(e,t,r){"use strict";var s=r("a947"),a=r.n(s);a.a},"84c1":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("q-card",{class:e.bgColor,attrs:{flat:"",square:"",bordered:""}},[r("div",{staticClass:"row q-py-sm"},[r("div",{staticClass:"col-xs-12 col-sm-6 ite-nam q-pa-xs",style:e.textColor},[e._v("\n        "+e._s(e.item.full_title)+"\n      ")]),r("div",{staticClass:"col-xs-12 col-sm-6 ite-ico flex justify-end "},[e.item.direct_product?r("q-btn",{style:e.textColor,attrs:{disable:"",flat:"",square:"",label:"ajout"}}):e._e(),e.item.has_dlc?r("q-btn",{style:e.textColor,attrs:{flat:"",square:"",label:e.dlcLabel,disable:e.closed},on:{click:function(t){e.dlcDate=!0}}}):e._e(),r("div",{staticClass:"row full-height items-center"},[r("q-chip",{staticClass:"quantity-chip",style:e.outlineRed,attrs:{color:e.bgChip,"text-color":"white",size:"16px",clickable:!e.closed},on:{click:function(t){e.quantityProblem=!0}}},[r("div",{staticClass:"text-center full-width"},[e._v("\n              "+e._s(e.chipText)+"\n            ")])])],1),e.item.direct_product?r("q-btn",{style:e.textColor,attrs:{flat:"",square:"",icon:e.checkIcon,disable:e.isDisable},on:{click:e.deleteItem}}):r("q-btn",{style:e.textColor,attrs:{flat:"",square:"",icon:e.checkIcon,disable:e.isDisable},on:{click:e.quantityIsFulfil}})],1)])]),r("q-dialog",{attrs:{"full-width":""},model:{value:e.dlcDate,callback:function(t){e.dlcDate=t},expression:"dlcDate"}},[r("q-card",{staticClass:"q-pa-xs"},[r("q-card-section",{staticClass:"row items-center"},[r("div",{staticClass:"dialog-box-title"},[e._v("\n          Choisir une date limite\n        ")])]),r("q-card-section",{staticClass:"row flex-center"},[r("q-date",{attrs:{locale:e.myLocale},model:{value:e.dlcDateSelection,callback:function(t){e.dlcDateSelection=t},expression:"dlcDateSelection"}})],1),r("q-card-section",{staticClass:"row flex-center"},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Retirer DLC",color:"primary"},on:{click:e.onDlcDelete}})],1),r("q-card-actions",{attrs:{align:"right"}},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Annuler",color:"primary"}}),r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Valider",color:"primary"},on:{click:e.onDlcDate}})],1)],1)],1),r("q-dialog",{attrs:{"full-width":""},model:{value:e.quantityProblem,callback:function(t){e.quantityProblem=t},expression:"quantityProblem"}},[r("QuantityAdjust",{attrs:{quantity:e.qty,ordered:e.item.quantity},on:{quantityModified:e.onQuantityModified,closeWindow:e.onCloseWindow}})],1)],1)},a=[],n=(r("a9e3"),r("ac1f"),r("1276"),r("2b0e")),i=r("c1df"),o=r.n(i),c=r("6849");n["a"].component("QuantityAdjust",c["default"]);var l={name:"CartItem",data:function(){return{chipText:null,bgColor:"white",textColor:"primary",bgChip:"primary",outlineRed:"border:none;",checkIcon:"check",isDisable:!1,dlcDate:!1,dlcDateSelection:"",myLocale:{days:"Dimanche_Lundi_Mardi_Mercredi_Jeudi_Vendredi_Samedi".split("_"),daysShort:"Dim_Lun_Mar_Mer_Jeu_Ven_Sam".split("_"),months:"Janvier_Février_Mars_Avril_Mai_Juin_Juillet_Août_Septembre_Octobre_Novembre_Décembre".split("_"),monthsShort:"Jan_Fév_Mar_Avr_Mai_Jui_Jui_Aoû_Sep_Oct_Nov_Déc".split("_")},dlcLabel:"DLC",quantityProblem:!1}},props:{item:{type:Object,required:!0},item_index:{type:Number,required:!0},closed:{type:Boolean,required:!0}},methods:{quantityIsFulfil:function(){var e={new_received:this.item.quantity,index:this.item_index};this.$emit("modifyReceived",e)},setChip:function(){""===this.item.received?(this.chipText=this.item.quantity,this.bgColor="bg-white",this.textColor="color: #027be3;",this.bgChip="primary",this.outlineRed="border:none;",this.checkIcon="check",this.isDisable=!1):this.item.received===this.item.quantity?(this.chipText=this.item.received,this.outlineRed="border:none;",!0===this.item.direct_product?(this.bgColor="bg-white",this.textColor="color: #027be3;",this.bgChip="primary",this.checkIcon="backspace",this.closed?this.isDisable=!0:this.isDisable=!1):(this.bgColor="bg-green",this.textColor="color: white;",this.bgChip="green-8",this.checkIcon="check_circle_outline",this.isDisable=!0)):this.item.received<this.item.quantity?(this.chipText=this.item.received+" / "+this.item.quantity,this.bgColor="bg-red",this.textColor="color: white;",this.bgChip="red-9",this.outlineRed="border:none;",this.checkIcon="cancel",this.isDisable=!0):this.item.received>this.item.quantity&&(this.chipText=this.item.received+" / "+this.item.quantity,this.bgColor="bg-green",this.textColor="color: white;",this.bgChip="green-8",this.outlineRed="border:solid #f44336 2px;",!0===this.item.direct_product?(this.checkIcon="backspace",this.closed?this.isDisable=!0:this.isDisable=!1):(this.checkIcon="check_circle_outline",this.isDisable=!0))},setDlcLabel:function(){this.item.has_dlc?this.dlcLabel=o()(this.item.dlc_date).format("DD/MM/YY"):this.dlcLabel="DLC"},deleteItem:function(){var e={index:this.item_index};this.$emit("deleteItem",e)},onDlcDate:function(){var e={new_dlcDate:o()(this.dlcDateSelection,"YYYY/MM/DD"),index:this.item_index};this.$emit("modifyDlc",e)},onDlcDelete:function(){var e={index:this.item_index};this.$emit("deleteDlc",e)},onQuantityModified:function(e){var t={new_received:e.data,index:this.item_index};this.$emit("modifyReceived",t)},onCloseWindow:function(){this.quantityProblem=!1}},created:function(){},mounted:function(){this.setChip(),this.setDlcLabel()},updated:function(){this.setChip(),this.setDlcLabel()},computed:{qty:function(){return""!==this.item.received?this.item.received:this.item.quantity}}},u=l,d=(r("21fe"),r("2877")),p=r("f09f"),m=r("9c40"),f=r("b047"),h=r("24e8"),v=r("a370"),_=r("52ee"),g=r("4b7e"),b=r("7f67"),y=r("eebe"),x=r.n(y),q=Object(d["a"])(u,s,a,!1,null,null,null);t["default"]=q.exports;x()(q,"components",{QCard:p["a"],QBtn:m["a"],QChip:f["a"],QDialog:h["a"],QCardSection:v["a"],QDate:_["a"],QCardActions:g["a"]}),x()(q,"directives",{ClosePopup:b["a"]})},9136:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-btn-toggle",{staticStyle:{border:"1px solid black","font-weight":"lighter"},attrs:{unelevated:"",size:"sm","toggle-color":"brown-4",color:"white","text-color":"black",options:[{label:"Frais",value:"fresh",icon:"ac_unit"},{label:"Sec",value:"dry",icon:"grass"},{value:"all",icon:"grass ac_unit",style:"padding: 10px"}]},model:{value:e.modeFilter,callback:function(t){e.modeFilter=t},expression:"modeFilter"}})},a=[],n={name:"ItemsFilter",computed:{modeFilter:{get:function(){return this.$store.getters["mvpPrep/modeFilter"]},set:function(e){this.$store.commit("mvpPrep/mutate_modeFilter",e)}}},watch:{modeFilter:{handler:function(e){this.$store.commit("mvpPrep/mutate_modeFilter",e)},deep:!0}}},i=n,o=r("2877"),c=r("6a67"),l=r("eebe"),u=r.n(l),d=Object(o["a"])(i,s,a,!1,null,"0ab711b2",null);t["default"]=d.exports;u()(d,"components",{QBtnToggle:c["a"]})},"92d5":function(e,t,r){var s={"./MvpPicking.vue":"b8d7","./MvpPicking/AddItem.vue":"10dc","./MvpPicking/CartItem.vue":"84c1","./MvpPicking/Comment.vue":"0096","./MvpPicking/MainMenu.vue":"aa0a","./MvpPicking/OrderTags.vue":"a4ac","./MvpPicking/PurchaseOrderDisplay.vue":"22f4","./MvpPicking/PurchaseOrdersList.vue":"b203","./MvpPicking/QuantityAdjust.vue":"6849","./MvpPicking/StickyBanner.vue":"d6b4","./MvpPicking/SupplierCard.vue":"693a","./MvpPicking/SupplierInfos.vue":"02ac","./MvpPrepOrders.vue":"7adf","./mvpPrepOrders/CallAction.vue":"bdd5","./mvpPrepOrders/ClientInfos.vue":"f7f2","./mvpPrepOrders/CollapsibleSection.vue":"70f4","./mvpPrepOrders/ItemsFilter.vue":"9136","./mvpPrepOrders/OrderCard.vue":"715d","./mvpPrepOrders/OrderInfos.vue":"43b9","./mvpPrepOrders/OrderItem.vue":"58d1","./mvpPrepOrders/OrderItems.vue":"713e","./mvpPrepOrders/OrdersDashboard.vue":"e26d","./mvpPrepOrders/OrdersList.vue":"3e33","./mvpPrepOrders/ShowOrder.vue":"00e0"};function a(e){var t=n(e);return r(t)}function n(e){if(!r.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}a.keys=function(){return Object.keys(s)},a.resolve=n,e.exports=a,a.id="92d5"},"9aaf":function(e,t,r){"use strict";var s=r("05e6"),a=r.n(s);a.a},"9c71":function(e,t,r){},"9f70":function(e,t,r){},a4ac:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"row justify-end items-center"},[e.has_direct?r("q-badge",{staticClass:"icon-spacer q-pa-xs",attrs:{color:e.badgeColor}},[e._v("\n      AJOUT(S)\n    ")]):e._e(),e.comments?r("q-badge",{staticClass:"icon-spacer q-pa-xs",attrs:{color:e.badgeColor}},[r("q-icon",{attrs:{name:"notes",color:"white"}})],1):e._e(),e.has_dlc?r("q-badge",{staticClass:"icon-spacer q-pa-xs",attrs:{color:e.badgeColor}},[e._v("\n      DLC\n    ")]):e._e(),e.closed?r("q-badge",{staticClass:"icon-spacer q-pa-xs",attrs:{color:e.badgeColor}},[r("q-icon",{attrs:{name:"lock",color:"white"}})],1):e._e(),r("q-badge",{staticClass:"icon-spacer text-uppercase q-pa-xs",attrs:{color:e.badgeColor}},[e._v("\n      "+e._s(e.textStatus)+"\n    ")])],1)])},a=[],n=(r("a9e3"),{name:"OrderTags",props:{closed:{type:Boolean,required:!0},cart_complete:{type:Number,required:!0},has_dlc:{type:Boolean,required:!0},comments:{type:Boolean,required:!0},has_direct:{type:Boolean,required:!0}},components:{},data:function(){return{}},methods:{},computed:{badgeColor:function(){return 0===this.cart_complete?"orange-9":1===this.cart_complete?"green-9":2===this.cart_complete?"primary":void 0},textStatus:function(){return 0===this.cart_complete?"commande incomplète":1===this.cart_complete?"commande complète":2===this.cart_complete?"en attente":void 0}},mounted:function(){}}),i=n,o=(r("a7d6"),r("2877")),c=r("58a8"),l=r("0016"),u=r("eebe"),d=r.n(u),p=Object(o["a"])(i,s,a,!1,null,null,null);t["default"]=p.exports;d()(p,"components",{QBadge:c["a"],QIcon:l["a"]})},a7d6:function(e,t,r){"use strict";var s=r("22f3"),a=r.n(s);a.a},a82c:function(e,t,r){"use strict";var s=r("4580"),a=r.n(s);a.a},a947:function(e,t,r){},aa0a:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("q-btn",{staticClass:"text-black q-px-md",attrs:{dense:"",flat:"",icon:"menu",color:"primary"}},[r("q-menu",{attrs:{anchor:"bottom right",self:"top right"}},[r("q-list",{staticStyle:{"min-width":"100px"}},[r("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}]},[r("q-item-section",{staticStyle:{"font-size":"1.2em","text-align":"right"}},[r("div",[e._v(e._s(e.username))]),r("div",{staticClass:"text-weight-thin"},[e._v(e._s(e.id))])])],1),r("q-separator"),r("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){e.slackDirect=!0}}},[r("q-item-section",{staticStyle:{"text-align":"right","font-size":"1.2em"}},[e._v("\n            Message slack\n          ")]),r("q-item-section",{attrs:{side:""}},[r("q-icon",{attrs:{name:"email"}})],1)],1),r("q-separator"),r("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){e.rangeDate=!0}}},[r("q-item-section",{staticStyle:{"text-align":"right","font-size":"1.2em"}},[e._v("\n            Periode\n          ")]),r("q-item-section",{attrs:{side:""}},[r("q-icon",{attrs:{name:"date_range"}})],1)],1),r("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){e.singleDate=!0}}},[r("q-item-section",{staticStyle:{"text-align":"right","font-size":"1.2em"}},[e._v("Jour")]),r("q-item-section",{attrs:{side:""}},[r("q-icon",{attrs:{name:"event"}})],1)],1),r("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:e.today}},[r("q-item-section",{staticStyle:{"text-align":"right","font-size":"1.2em"}},[e._v("Aujourd'hui")]),r("q-item-section",{attrs:{side:""}},[r("q-icon",{attrs:{name:"calendar_today"}})],1)],1)],1)],1)],1),r("q-dialog",{attrs:{"full-width":""},model:{value:e.slackDirect,callback:function(t){e.slackDirect=t},expression:"slackDirect"}},[r("q-card",{staticClass:"q-pa-xs"},[r("q-card-section",{staticClass:"row items-center"},[r("div",{staticClass:"dialog-box-title"},[e._v("\n          Envoyer un message sur slack\n        ")])]),r("q-card-section",{staticClass:"row flex-center"},[r("q-input",{staticClass:"full-width",attrs:{filled:"",type:"textarea"},model:{value:e.slackMsg,callback:function(t){e.slackMsg=t},expression:"slackMsg"}})],1),r("q-card-actions",{attrs:{align:"right"}},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Annuler",color:"primary"}}),r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Envoyer",color:"primary"},on:{click:e.sendToSlack}})],1)],1)],1),r("q-dialog",{ref:"singleDateDialog",model:{value:e.singleDate,callback:function(t){e.singleDate=t},expression:"singleDate"}},[r("q-date",{attrs:{locale:e.myLocale,landscape:e.isLandscape},on:{input:e.onDateSelect},model:{value:e.dateSelection,callback:function(t){e.dateSelection=t},expression:"dateSelection"}})],1),r("q-dialog",{ref:"rangeDateDialog",model:{value:e.rangeDate,callback:function(t){e.rangeDate=t},expression:"rangeDate"}},[r("q-date",{attrs:{locale:e.myLocale,range:"",landscape:e.isLandscape},on:{input:e.onRangeSelect},model:{value:e.dateSelection,callback:function(t){e.dateSelection=t},expression:"dateSelection"}})],1)],1)},a=[],n=(r("ac1f"),r("1276"),r("ded3")),i=r.n(n),o=(r("96cf"),r("c973")),c=r.n(o),l=r("c1df"),u=r.n(l),d=r("2f62"),p={name:"MainMenu",data:function(){return{id:null,slackDirect:!1,slackMsg:"",singleDate:!1,dateSelection:"",myLocale:{days:"Dimanche_Lundi_Mardi_Mercredi_Jeudi_Vendredi_Samedi".split("_"),daysShort:"Dim_Lun_Mar_Mer_Jeu_Ven_Sam".split("_"),months:"Janvier_Février_Mars_Avril_Mai_Juin_Juillet_Août_Septembre_Octobre_Novembre_Décembre".split("_"),monthsShort:"Jan_Fév_Mar_Avr_Mai_Jui_Jui_Aoû_Sep_Oct_Nov_Déc".split("_"),firstDayOfWeek:1},rangeDate:!1}},methods:{today:function(){this.$emit("today")},sendToSlack:function(){var e=this;return c()(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r={},r.date=u()(),r.user=e.$store.getters.creds.user.firstname,r.msg=e.slackMsg,r.apiUrl=e.$store.getters.apiurl,r.apiKey=e.$store.getters.activeApp.config.restApiKey,r.type="direct",t.prev=7,t.next=10,e.$store.dispatch("mvp/sendMessageToSlack",r);case 10:e.$q.notify({message:"Message envoyé !",timeout:5e3,color:"green"}),t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](7),e.$q.notify({message:"Un problème est survenu, veuillez re-essayer plus tard.",timeout:5e3,color:"red"});case 16:case"end":return t.stop()}}),t,null,[[7,13]])})))()},onDateSelect:function(){this.$refs.singleDateDialog.hide();var e={fr:u()(this.dateSelection,"YYYY/MM/DD").startOf("day"),to:u()(this.dateSelection,"YYYY/MM/DD").endOf("day")};this.$emit("newDates",{data:e})},onRangeSelect:function(){this.$refs.rangeDateDialog.hide();var e={fr:u()(this.dateSelection.from,"YYYY/MM/DD").startOf("day"),to:u()(this.dateSelection.to,"YYYY/MM/DD").endOf("day")};this.$emit("newDates",{data:e})}},computed:i()(i()({},Object(d["b"])(["creds"])),{},{username:function(){return this.creds.user.firstname+" "+this.creds.user.lastname},isLandscape:function(){return!(this.$store.state.mvp.screenSize.windowWidth>1e3)&&this.$store.state.mvp.screenSize.windowWidth>this.$store.state.mvp.screenSize.windowHeight}})},m=p,f=(r("0b9b"),r("2877")),h=r("9c40"),v=r("4e73"),_=r("1c1c"),g=r("66e5"),b=r("4074"),y=r("eb85"),x=r("0016"),q=r("24e8"),O=r("f09f"),w=r("a370"),k=r("27f9"),C=r("4b7e"),P=r("52ee"),S=r("7f67"),I=r("eebe"),$=r.n(I),j=Object(f["a"])(m,s,a,!1,null,null,null);t["default"]=j.exports;$()(j,"components",{QBtn:h["a"],QMenu:v["a"],QList:_["a"],QItem:g["a"],QItemSection:b["a"],QSeparator:y["a"],QIcon:x["a"],QDialog:q["a"],QCard:O["a"],QCardSection:w["a"],QInput:k["a"],QCardActions:C["a"],QDate:P["a"]}),$()(j,"directives",{ClosePopup:S["a"]})},b203:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-page-container",[r("q-page",[r("div",{staticClass:"q-pa-none"},[r("q-list",{staticClass:"supplier-list"},[e._l(e.allPurchaseOrders,(function(t){return r("SupplierCard",e._b({key:t.id},"SupplierCard",t,!1))})),0===e.allPurchaseOrders.length?[r("q-card",{staticClass:"bg-white fixed-center card-aucun"},[r("q-card-section",{staticClass:"row"},[r("div",{staticClass:"text-italic text-caption aucun"},[e._v("\n                Aucun bon de commande trouvé !\n              ")])])],1)]:e._e()],2)],1),r("q-page-sticky",{attrs:{expand:"",position:"top"}},[r("StickyBanner",{ref:"StickyBannerInstance"})],1)],1)],1)},a=[],n=(r("4160"),r("a630"),r("3ca3"),r("159b"),r("2b0e")),i=r("bc3a"),o=r.n(i),c=r("c1df"),l=r.n(c),u=r("d6b4"),d=r("693a");n["a"].component("StickyBanner",u["default"]),n["a"].component("SupplierCard",d["default"]);var p={name:"PurchaseOrdersList",components:{StickyBanner:u["default"],SupplierCard:d["default"]},data:function(){return{original_allPurchaseOrders:[],allPurchaseOrders:[],queryList:{size:5e3,sort:[{expected_date:{order:"desc",unmapped_type:"boolean"}}],_source:{includes:["number","status","type","expected_date","supplier","line_items","comment","units_ordered","units_received","updated_at","validated","closed","cart_complete","has_dlc","comments"]},query:{bool:{must:[{range:{expected_date:{gte:"",lte:""}}}]}}},indice:"purchase_order*",marker:!1}},computed:{targetDate:function(){return this.$store.getters["mvp/targetDate"]}},watch:{targetDate:{handler:function(){this.getPoList()},deep:!0}},methods:{getPoList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===t?(this.queryList.query.bool.must[0].range.expected_date.gte=this.targetDate.dateFrom,this.queryList.query.bool.must[0].range.expected_date.lte=this.targetDate.dateTo):(this.queryList.query.bool.must[0].range.expected_date.gte=t.dateFrom,this.queryList.query.bool.must[0].range.expected_date.lte=t.dateTo);var r=this.$store.getters.apiurl+"generic_search/"+this.indice+"?token="+this.$store.getters.creds.token;this.$q.loading.show(),o.a.post(r,this.queryList).then((function(t){e.allPurchaseOrders=[];for(var r=0;r<t.data.records.length;r++)e.allPurchaseOrders.push(t.data.records[r]._source),e.allPurchaseOrders[r].id=t.data.records[r]._id,e.allPurchaseOrders[r].index=t.data.records[r]._index;e.original_allPurchaseOrders=e.allPurchaseOrders,e.checkPurchaseOrderModel(),e.allPurchaseOrders.forEach((function(e){e.units_ordered&&e.units_received&&(0==e.units_received||e.units_received<e.units_ordered?e.cart_complete=0:e.units_received>=e.units_ordered&&(e.cart_complete=1))})),e.orderTheOrders(),e.$store.commit("mvpPicking/mutate_allPurchaseOrders",{data:e.allPurchaseOrders});var s=e.allPurchaseOrders;e.allPurchaseOrders=null,e.allPurchaseOrders=s,e.$q.loading.hide()})).catch((function(t){e.$q.loading.hide()}))},checkPurchaseOrderModel:function(){for(var e=0;e<this.allPurchaseOrders.length;e++)this.allPurchaseOrders[e].hasOwnProperty("closed")||(this.allPurchaseOrders[e].closed=!1),this.allPurchaseOrders[e].hasOwnProperty("cart_complete")||(this.allPurchaseOrders[e].cart_complete=2),this.allPurchaseOrders[e].hasOwnProperty("has_dlc")||(this.allPurchaseOrders[e].has_dlc=!1),this.allPurchaseOrders[e].hasOwnProperty("comments")||(this.allPurchaseOrders[e].comments=JSON.stringify(new Array)),this.allPurchaseOrders[e].hasOwnProperty("has_direct_product")||(this.allPurchaseOrders[e].has_direct_product=!1),this.checkItemsModel(e)},checkItemsModel:function(e){for(var t=Array.from(JSON.parse(this.allPurchaseOrders[e].line_items)),r=0;r<t.length;r++)t[r].hasOwnProperty("received")||(t[r].received=""),t[r].hasOwnProperty("dlc")&&(t[r].hasOwnProperty("dlc_date")||(t[r].dlc_date="")),t[r].hasOwnProperty("direct_product")&&(this.allPurchaseOrders[e].has_direct_product=!0);this.allPurchaseOrders[e].line_items=JSON.stringify(t)},orderTheOrders:function(){for(var e=this,t=[],r=0;r<this.allPurchaseOrders.length;r++)2===this.allPurchaseOrders[r].cart_complete&&t.push(this.allPurchaseOrders[r]);t.sort((function(e,t){var r=e.supplier.toLowerCase(),s=t.supplier.toLowerCase();return r<s?-1:r>s?1:0})),t.sort((function(e,t){var r=l()(e.expected_date).format("YYYY/MM/DD"),s=l()(t.expected_date).format("YYYY/MM/DD");return r<s?-1:r>s?1:0}));for(var s=[],a=0;a<this.allPurchaseOrders.length;a++)0===this.allPurchaseOrders[a].cart_complete&&s.push(this.allPurchaseOrders[a]);s.sort((function(e,t){var r=e.supplier.toLowerCase(),s=t.supplier.toLowerCase();return r<s?-1:r>s?1:0})),s.sort((function(e,t){var r=l()(e.expected_date).format("YYYY/MM/DD"),s=l()(t.expected_date).format("YYYY/MM/DD");return r<s?-1:r>s?1:0}));for(var n=[],i=0;i<this.allPurchaseOrders.length;i++)1===this.allPurchaseOrders[i].cart_complete&&n.push(this.allPurchaseOrders[i]);n.sort((function(e,t){var r=e.supplier.toLowerCase(),s=t.supplier.toLowerCase();return r<s?-1:r>s?1:0})),n.sort((function(e,t){var r=l()(e.expected_date).format("YYYY/MM/DD"),s=l()(t.expected_date).format("YYYY/MM/DD");return r<s?-1:r>s?1:0})),this.allPurchaseOrders=[],t.forEach((function(t){e.allPurchaseOrders.push(t)})),s.forEach((function(t){e.allPurchaseOrders.push(t)})),n.forEach((function(t){e.allPurchaseOrders.push(t)}))}},mounted:function(){this.getPoList();var e=1e3*this.$store.getters["mvp/timer"];this.interval=setInterval(function(){this.getPoList()}.bind(this),e)},beforeDestroy:function(){clearInterval(this.interval)}},m=p,f=(r("ea63"),r("2877")),h=r("09e3"),v=r("9989"),_=r("1c1c"),g=r("f09f"),b=r("a370"),y=r("de5e"),x=r("eebe"),q=r.n(x),O=Object(f["a"])(m,s,a,!1,null,null,null);t["default"]=O.exports;q()(O,"components",{QPageContainer:h["a"],QPage:v["a"],QList:_["a"],QCard:g["a"],QCardSection:b["a"],QPageSticky:y["a"]})},b34d:function(e,t,r){},b8d7:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-page",{staticClass:"flex bg-grey-5 row"},[r("q-resize-observer",{attrs:{debounce:"500"},on:{resize:e.onResize}}),e.isPurchaseOrderDisplayed?r("div",{staticClass:"bg-grey-2  full-width"},[r("PurchaseOrderDisplay")],1):r("div",{staticClass:"bg-grey-2 full-width"},[r("PurchaseOrdersList")],1)],1)},a=[],n=r("2b0e"),i=(r("bc3a"),r("c1df"),r("b203")),o=r("22f4");n["a"].component("PurchaseOrdersList",i["default"]),n["a"].component("PurchaseOrderDisplay",o["default"]);var c={name:"MvpPicking",components:{PurchaseOrdersList:i["default"],PurchaseOrderDisplay:o["default"]},data:function(){return{leftDrawerOpen:!1,isPurchaseOrderDisplayed:!1,marker:!1}},methods:{addEventListener:function(){var e=this;this.$root.$on("displayOrderEvent",(function(t){e.displayOrderEvent(t)})),this.$root.$on("displayListEvent",(function(t){e.displayListEvent(t)}))},removeEventListener:function(){this.$root.$off("displayOrderEvent"),this.$root.$off("displayListEvent")},displayOrderEvent:function(e){this.$store.commit("mvpPicking/mutate_currentOrder",{order:{meta:{id:e.id,index:e.index}}}),this.isPurchaseOrderDisplayed=!0},displayListEvent:function(e){this.$store.commit("mvpPicking/mutate_currentOrder",{order:{meta:{id:"",index:""}}}),this.isPurchaseOrderDisplayed=!1},onResize:function(e){var t={windowWidth:window.innerWidth,windowHeight:window.innerHeight,appHeight:e.height,appWidth:e.width};this.$store.commit("mvp/mutate_screenSize",{data:t})}},beforeCreate:function(){this.$q.platform.is.mobile&&this.$q.fullscreen.request().then((function(){})).catch((function(e){}))},created:function(){this.addEventListener()},beforeMount:function(){},mounted:function(){},beforeDestroy:function(){this.removeEventListener()},destroyed:function(){this.$q.platform.is.mobile&&this.$q.fullscreen.exit().then((function(){})).catch((function(e){}))},computed:{}},l=c,u=r("2877"),d=r("9989"),p=r("3980"),m=r("eebe"),f=r.n(m),h=Object(u["a"])(l,s,a,!1,null,null,null);t["default"]=h.exports;f()(h,"components",{QPage:d["a"],QResizeObserver:p["a"]})},bc6c:function(e,t,r){"use strict";var s=r("cbff"),a=r.n(s);a.a},bdd5:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:["row full-width justify-center q-pa-md text-white","bg-"+e.backgroundColor]},[e._m(0),r("div",{staticClass:"col-xs-3 col-sm-6 col-md-4  row justify-end items-center"},[r("div",[r("q-btn",{staticClass:"q-ma-sm",attrs:{label:"Try it now",color:"black"}})],1)])])},a=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("h4",{staticClass:"col-xs-9 col-sm-6 col-md-4  row justify-center q-ma-none"},[r("div",{staticStyle:{"max-width":"450px"}},[e._v("\n      A fully featured todo App\n    ")])])}],n={name:"CallAction",props:{backgroundColor:{type:String,default:"secondary"}}},i=n,o=r("2877"),c=r("9c40"),l=r("eebe"),u=r.n(l),d=Object(o["a"])(i,s,a,!1,null,null,null);t["default"]=d.exports;u()(d,"components",{QBtn:c["a"]})},c9fc:function(e,t,r){},cbff:function(e,t,r){},d6b4:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"bg-brown-2 full-width flex row grey-banner"},[r("div",{staticClass:"text-dark text-subtitle1 date-banner row col-xs-10 justify-center"},[e.dateFromShort===e.dateToShort?r("div",{staticClass:"text-center"},[e._v("\n      Date : "),r("b",[e._v(e._s(e._f("dateFrench")(e.dateFrom)))])]):r("div",{staticClass:"text-center"},[e._v("\n      Période : du "),r("b",[e._v(e._s(e._f("dateFrench")(e.dateFrom)))]),e._v(" au\n      "),r("b",[e._v(e._s(e._f("dateFrench")(e.dateTo)))])])]),r("div",{staticClass:"menu-banner row col-xs-2 justify-center"},[r("MainMenu",{on:{today:e.onToday,newDates:e.onNewDates}})],1)])},a=[],n=r("2b0e"),i=r("c1df"),o=r.n(i),c=r("aa0a");n["a"].component("MainMenu",c["default"]);var l={name:"StickyBanner",data:function(){return{dateFrom:null,dateTo:null,dateFromShort:null,dateToShort:null}},methods:{setNewDates:function(e,t){this.dateFrom=e,this.dateTo=t,this.dateFromShort=o()(this.dateFrom).format("DD-MM-YYYY"),this.dateToShort=o()(this.dateTo).format("DD-MM-YYYY");var r={dateFrom:this.dateFrom,dateTo:this.dateTo,dateFromShort:this.dateFromShort,dateToShort:this.dateToShort};this.$store.commit("mvp/mutate_targetDate",{dateObj:r})},onToday:function(){var e=o()().startOf("day"),t=o()().endOf("day");this.setNewDates(e,t)},onNewDates:function(e){this.setNewDates(e.data.fr,e.data.to)}},created:function(){""===this.$store.getters["mvp/targetDate"].dateFrom&&this.onToday()},mounted:function(){this.dateFrom=this.$store.getters["mvp/targetDate"].dateFrom,this.dateTo=this.$store.getters["mvp/targetDate"].dateTo,this.dateFromShort=this.$store.getters["mvp/targetDate"].dateFromShort,this.dateToShort=this.$store.getters["mvp/targetDate"].dateToShort},beforeDestroy:function(){this.dateFrom=null,this.dateTo=null,this.dateFromShort=null,this.dateToShort=null},computed:{}},u=l,d=(r("bc6c"),r("2877")),p=Object(d["a"])(u,s,a,!1,null,null,null);t["default"]=p.exports},d6db:function(e,t,r){},da41:function(e,t,r){"use strict";var s=r("e196"),a=r.n(s);a.a},dad6:function(e,t,r){},e196:function(e,t,r){},e26d:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"row justify-center",staticStyle:{"font-size":"20px","font-weight":"bold","padding-bottom":"50px"}},[e._v("\n    DASHBOARD\n  ")]),r("q-list",{staticClass:" row flex justify-center fullwidth"},[r("q-item",{staticClass:"row col-xs-10 justify-center text-white",staticStyle:{"background-color":"#EABD5A","padding-bottom":"30px","margin-bottom":"30px","border-radius":"20px"},attrs:{clickable:""},on:{click:function(t){return e.goToOrdersList("all")}}},[r("div",{staticClass:"row col-xs-10 justify-center text-h6",staticStyle:{"text-align":"center"}},[e._v("\n        Commandes du jour\n        "),r("div",{staticClass:"row col-xs-10 justify-center text-h4",staticStyle:{"font-weight":"bold"}},[e._v("\n          "+e._s(e.orders.length)+"\n        ")])])]),r("q-item",{staticClass:"row col-xs-10 justify-center text-white",staticStyle:{"background-color":"seagreen","padding-bottom":"30px","border-radius":"20px"},attrs:{clickable:""},on:{click:function(t){return e.goToOrdersList("finished")}}},[r("div",{staticClass:"row col-xs-10 justify-center text-h6",staticStyle:{"text-align":"center"}},[e._v("\n        Commandes prêtes à expédier\n        "),r("div",{staticClass:"row col-xs-10 justify-center text-h4",staticStyle:{"font-weight":"bold"}},[e._v("\n          "+e._s(e.orders.filter((function(e){return void 0!==e._source.prep_status&&("finished"===e._source.prep_status||"finishedWithRemb"===e._source.prep_status||"finishedWithReplaced"===e._source.prep_status)})).length)+"\n        ")])])])],1),r("q-page-sticky",{attrs:{expand:"",position:"top"}},[r("StickyBanner",{staticClass:"row items-center",staticStyle:{height:"50px"}})],1)],1)},a=[],n=r("ded3"),i=r.n(n),o=r("2f62"),c=(r("6f51"),{name:"OrdersDashboard",mixins:["mixin"],computed:i()({},Object(o["c"])("mvpPrep",["orders"])),methods:{goToOrdersList:function(e){"finished"===e&&this.$store.commit("mvpPrep/mutate_openFinishedOrders",!0),this.$router.push({query:{path:"ordersList"}})}},created:function(){this.$store.commit("mvpPrep/mutate_openFinishedOrders",!1)}}),l=c,u=r("2877"),d=r("1c1c"),p=r("66e5"),m=r("de5e"),f=r("eebe"),h=r.n(f),v=Object(u["a"])(l,s,a,!1,null,"03d9d036",null);t["default"]=v.exports;h()(v,"components",{QList:d["a"],QItem:p["a"],QPageSticky:m["a"]})},e8f2:function(e,t,r){},ea63:function(e,t,r){"use strict";var s=r("9f70"),a=r.n(s);a.a},ea82:function(e,t,r){"use strict";var s=r("e8f2"),a=r.n(s);a.a},f1a5:function(e,t,r){"use strict";var s=r("6339"),a=r.n(s);a.a},f2f1:function(e,t,r){"use strict";var s=r("6d0e"),a=r.n(s);a.a},f6c3:function(e,t,r){"use strict";var s=r("d6db"),a=r.n(s);a.a},f7f2:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"row q-pa-xs"},[r("div",{staticClass:"col-xs-12 col-sm-6 q-pa-sm"},[r("q-list",{attrs:{bordered:"",separator:""}},[r("q-item",[r("q-item-section",[e._v("\n          Nom :\n        ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n          "+e._s(e.currentOrder._source.last_name)+"\n        ")])],1),r("q-item",[r("q-item-section",[e._v("\n          Prénom :\n        ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n          "+e._s(e.currentOrder._source.first_name)+"\n        ")])],1),r("q-item",[r("q-item-section",[e._v("\n          Nombre de commandes :\n        ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n          "+e._s(e.currentOrder._source.customer_order_count)+"\n        ")])],1)],1)],1)])},a=[],n=r("ded3"),i=r.n(n),o=r("2f62"),c={name:"ClientInfos",computed:i()({},Object(o["c"])("mvpPrep",["currentOrder"]))},l=c,u=r("2877"),d=r("1c1c"),p=r("66e5"),m=r("4074"),f=r("eebe"),h=r.n(f),v=Object(u["a"])(l,s,a,!1,null,"8ce34300",null);t["default"]=v.exports;h()(v,"components",{QList:d["a"],QItem:p["a"],QItemSection:m["a"]})},fbe3:function(e,t,r){},ff5b:function(e,t,r){}});